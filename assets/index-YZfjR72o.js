var Je=Object.defineProperty;var Ze=(a,t,i)=>t in a?Je(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i;var r=(a,t,i)=>Ze(a,typeof t!="symbol"?t+"":t,i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const h of l.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&s(h)}).observe(document,{childList:!0,subtree:!0});function i(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(n){if(n.ep)return;n.ep=!0;const l=i(n);fetch(n.href,l)}})();const ie={axe:new Image,gun:new Image},se={light:new Image,flame:new Image},ce={medkit:new Image,fuel:new Image,ammo:new Image},M={axe:new Image,gun:new Image,direction:new Image},v={Q:!1,F:!1,E:!1,R:!1,SPACE:!1},T={Ophelia:{front:[],back:[],right:[],left:[]},Noah:{front:[],back:[],right:[],left:[]}},A={goblinImages:{front:[],back:[],right:[],left:[]},bossImages:{front:[],back:[],right:[],left:[]},bloodParticleImages:[],pickupItems:{medkit:[]}};var g=(a=>(a.menuScreen="welcomeScreen",a.running="running",a.paused="paused",a.resume="resume",a.retryScreen="retryScreen",a.restart="restart",a.gameFinish="gameFinish",a.controlsScreen="controlsScreen",a.aboutScreen="aboutScreen",a.loadingScreen="loadingScreen",a))(g||{});const he={0:{enemySpeed:2,enemyMinHealth:1,enemyMaxHealth:3,enemyAttackDamage:.5},1:{enemySpeed:2.5,enemyMinHealth:2,enemyMaxHealth:5,enemyAttackDamage:1},2:{enemySpeed:3,enemyMinHealth:3,enemyMaxHealth:6,enemyAttackDamage:1.5}},de={health_pack:{itemName:"health_pack"},fuel:{itemName:"fuel"},ammo:{itemName:"ammo",count:20}},S={medKit:0,fuel:0,ammo:100,weapons:{axe:{damage:2},gun:{damage:1}}},B={difficultyLevel:0,character:"Ophelia"},e={ctx:{},player:{},bgImage:{},inventory:{},windowWidth:window.innerWidth,windowHeight:window.innerHeight,debugCollider:!1,adjustDeviceColliderX:(window.innerWidth-1536)/2,adjustDeviceColliderY:(window.innerHeight-753)/2,bulletProjectileArray:[],fireProjectileArray:[],lantern:{},refuelStart:0,isHoldingRefuelKey:!1,healStart:0,isHoldingHealKey:!1,refuelDuration:2e3,healDuration:1e3,enemiesArray:[],animateEnemyArray:[],bloodParticleArray:[],ui:{},rain:!0,reqAnimFrame:0,keyState:{},mainMenu:{},controlsScreen:{},aboutScreen:{},loadingScreen:{},mouseCoords:{x:0,y:0},gameState:"loadingScreen",tempGameState:"loadingScreen",pickupItemsArray:[],animatePickupItemsArray:[],cursorImage:{},axe:{},gun:{},boss:{},flameImages:[],assetsLoadCount:0};class o{constructor(t,i){r(this,"x");r(this,"y");this.x=t,this.y=i}}const je=1,et=5e3,_=50,tt=150,it=2,st=80,ot=2,at=1e3,nt=4,rt=100,lt=100,ht=5e3,dt=1e3,ne=250;class oe{constructor(t,i){r(this,"startPoint");r(this,"state");r(this,"blood_img");r(this,"show");this.startPoint=new o(t,i),this.state=0,this.show=!0,this.blood_img=A.bloodParticleImages}updateState(){for(let t=0;t<this.blood_img.length-1;t++)setTimeout(()=>{this.state++},90*t)}showAnimation(t=e.ctx){this.show&&t.drawImage(this.blood_img[this.state],this.startPoint.x+e.bgImage.startPoint.x,this.startPoint.y+e.bgImage.startPoint.y);const i=setTimeout(()=>{this.show=!1,clearTimeout(i)},et)}}const d={diegoblins:{audio:new Audio("./assets/sound/voice/dieyougoblins.mp3"),hasPlayed:!1,canPlayAgain:!0},howsharp:{audio:new Audio("./assets/sound/voice/howsharp.mp3"),hasPlayed:!1,canPlayAgain:!0},idontfeelsogood:{audio:new Audio("./assets/sound/voice/idontfeelsogood.mp3"),hasPlayed:!1,canPlayAgain:!0},isthatboss:{audio:new Audio("./assets/sound/voice/isthatthegoblinboss.mp3"),hasPlayed:!1,canPlayAgain:!1},ithurts:{audio:new Audio("./assets/sound/voice/ithurts.mp3"),hasPlayed:!1,canPlayAgain:!0},lanternrunningout:{audio:new Audio("./assets/sound/voice/lanternisrunningout.mp3"),hasPlayed:!1,canPlayAgain:!0},letsstartkilling:{audio:new Audio("./assets/sound/voice/letsstartkillinggoblins.mp3"),hasPlayed:!1,canPlayAgain:!0},notready:{audio:new Audio("./assets/sound/voice/notreadyyet.mp3"),hasPlayed:!1,canPlayAgain:!0},outofammo:{audio:new Audio("./assets/sound/voice/outofammo.mp3"),hasPlayed:!1,canPlayAgain:!0},outoffuel:{audio:new Audio("./assets/sound/voice/outoflanternfuel.mp3"),hasPlayed:!1,canPlayAgain:!0},outofmedkit:{audio:new Audio("./assets/sound/voice/outofmedkit.mp3"),hasPlayed:!1,canPlayAgain:!0},wedidit:{audio:new Audio("./assets/sound/voice/yaywedidit.mp3"),hasPlayed:!1,canPlayAgain:!1},axesound:{audio:new Audio("./assets/sound/axesound.mp3"),hasPlayed:!1,canPlayAgain:!0},breathofdragon:{audio:new Audio("./assets/sound/voice/breathofdragon.mp3"),hasPlayed:!1,canPlayAgain:!0},hmmaxe:{audio:new Audio("./assets/sound/voice/hmmaxe.mp3"),hasPlayed:!1,canPlayAgain:!0},gunfire:{audio:new Audio("./assets/sound/gunfire.mp3"),hasPlayed:!1,canPlayAgain:!0},iamtired:{audio:new Audio("./assets/sound/voice/iamtired.mp3"),hasPlayed:!1,canPlayAgain:!0},lightofblessings:{audio:new Audio("./assets/sound/voice/lightofblessings.mp3"),hasPlayed:!1,canPlayAgain:!0},yaygun:{audio:new Audio("./assets/sound/voice/yaygun.mp3"),hasPlayed:!1,canPlayAgain:!0},walk:{audio:new Audio("./assets/sound/walk.mp3"),hasPlayed:!1,canPlayAgain:!0},run:{audio:new Audio("./assets/sound/walk.mp3"),hasPlayed:!1,canPlayAgain:!0},zombiegrunt:{audio:new Audio("./assets/sound/zombiegrunt.mp3"),hasPlayed:!1,canPlayAgain:!0},wind:{audio:new Audio("./assets/sound/wind.mp3"),hasPlayed:!1,canPlayAgain:!0},bossroar:{audio:new Audio("./assets/sound/bossroar.mp3"),hasPlayed:!1,canPlayAgain:!0},bosswakeup:{audio:new Audio("./assets/sound/bosswakeup.mp3"),hasPlayed:!1,canPlayAgain:!0},refueling:{audio:new Audio("./assets/sound/refueling.mp3"),hasPlayed:!1,canPlayAgain:!0},usingmedkit:{audio:new Audio("./assets/sound/usingmedkit.mp3"),hasPlayed:!1,canPlayAgain:!0},bosscallingallgoblins:{audio:new Audio("./assets/sound/voice/bosscallingallgoblins.mp3"),hasPlayed:!1,canPlayAgain:!1},bosshaswakenup:{audio:new Audio("./assets/sound/voice/bosshaswakenup.mp3"),hasPlayed:!1,canPlayAgain:!1},itfeelsgood:{audio:new Audio("./assets/sound/voice/itfeelsgood.mp3"),hasPlayed:!1,canPlayAgain:!0},refuelingdone:{audio:new Audio("./assets/sound/voice/refuelingdone.mp3"),hasPlayed:!1,canPlayAgain:!0},wefailed:{audio:new Audio("./assets/sound/voice/wefailed.mp3"),hasPlayed:!1,canPlayAgain:!0},cantgobeyondthis:{audio:new Audio("./assets/sound/voice/cantgobeyondthis.mp3"),hasPlayed:!1,canPlayAgain:!0},collidedontosomething:{audio:new Audio("./assets/sound/voice/collidedontosomething.mp3"),hasPlayed:!1,canPlayAgain:!0},foundfuel:{audio:new Audio("./assets/sound/voice/foundfuel.mp3"),hasPlayed:!1,canPlayAgain:!0},foundmedkits:{audio:new Audio("./assets/sound/voice/foundmedkits.mp3"),hasPlayed:!1,canPlayAgain:!0},moreammo:{audio:new Audio("./assets/sound/voice/moreammo.mp3"),hasPlayed:!1,canPlayAgain:!0},medkitpickup:{audio:new Audio("./assets/sound/medkitpickup.mp3"),hasPlayed:!1,canPlayAgain:!0},fuelpickup:{audio:new Audio("./assets/sound/fuelpickup.mp3"),hasPlayed:!1,canPlayAgain:!0},ammopickup:{audio:new Audio("./assets/sound/ammopickup.mp3"),hasPlayed:!1,canPlayAgain:!0},optionhover:{audio:new Audio("./assets/sound/optionhover.mp3"),hasPlayed:!1,canPlayAgain:!0},optionclick:{audio:new Audio("./assets/sound/optionclick.mp3"),hasPlayed:!1,canPlayAgain:!0},mainmenumusic:{audio:new Audio("./assets/sound/mainmenumusic.mp3"),hasPlayed:!1,canPlayAgain:!0},lightsound:{audio:new Audio("./assets/sound/lightsound.mp3"),hasPlayed:!1,canPlayAgain:!0},flamesound:{audio:new Audio("./assets/sound/flamesound.mp3"),hasPlayed:!1,canPlayAgain:!0},homesweethome:{audio:new Audio("./assets/sound/homesweethome.mp3"),hasPlayed:!1,canPlayAgain:!1},aboutvoice:{audio:new Audio("./assets/sound/voice/aboutvoice.mp3"),hasPlayed:!1,canPlayAgain:!1}};function R(a,t){return a+Math.floor((t-a)*Math.random())}function E(a,t){const i=t.x-a.x,s=t.y-a.y;return Math.sqrt(i**2+s**2)}function ye(a,t){const i=a.x-t.x,s=a.y-t.y;return Math.atan2(s,i)}function y(a,t){a.audio.paused&&(a.hasPlayed&&!a.canPlayAgain||Math.random()<t&&(a.audio&&(a.audio.pause(),a.audio.currentTime=0),a.audio.play(),a.hasPlayed=!0))}function yt(){e.player.health<30&&e.gameState==g.running&&y(d.idontfeelsogood,.001),E(e.player.startPoint,e.boss.startPoint)<200&&y(d.isthatboss,.01),e.lantern.maxRadiusInnerCircle<80&&e.gameState==g.running&&y(d.lanternrunningout,.01),e.gameState==g.running?(d.wind.audio.volume=.4,y(d.wind,1)):(d.wind.audio.pause(),d.wind.audio.currentTime=0),e.gameState==g.menuScreen||e.gameState==g.retryScreen||e.gameState==g.paused||e.gameState==g.controlsScreen?(d.mainmenumusic.audio.volume=.4,y(d.mainmenumusic,1)):(d.mainmenumusic.audio.pause(),d.mainmenumusic.audio.currentTime=0)}function ct(){for(const a in d)d.hasOwnProperty(a)&&d[a].hasPlayed&&!d[a].canPlayAgain&&(d[a].hasPlayed=!1)}class Ue{constructor(t,i,s,n){r(this,"startPoint");r(this,"initialX");r(this,"initialY");r(this,"r");r(this,"endPoint");r(this,"movement_speed");r(this,"dir");r(this,"toDelete");r(this,"images");r(this,"spritePos");r(this,"owner");r(this,"dirX");r(this,"dirY");r(this,"dist");r(this,"angle");this.startPoint=new o(t.x-30,t.y+30),this.dir=i,this.initialX=this.startPoint.x,this.initialY=this.startPoint.y,this.r=5,this.endPoint=new o(s.x*1.05,s.y*1.05),this.movement_speed=10,this.toDelete=!1,this.images=[],this.spritePos=0,this.initialiseImages(),this.owner=n,this.dirX=0,this.dirY=0,this.dist=0,this.angle=0,this.calculateTrajectory()}initialiseImages(){this.images=e.flameImages}show(t=e.ctx){let s=Math.floor(this.spritePos/5)%30;t.save(),t.translate(this.startPoint.x,this.startPoint.y),t.rotate(this.angle),t.drawImage(this.images[s],-100,-100,200,200),t.restore(),this.spritePos++}hits(t){let i=E(new o(this.startPoint.x-100,this.startPoint.y-130),new o(t.startPoint.x-50,t.startPoint.y-50));return this.owner=="player"&&y(d.howsharp,1),i<this.r+t.r}evaporate(){this.toDelete=!0}calculateTrajectory(){let t=this.endPoint.x-this.startPoint.x,i=this.endPoint.y-this.startPoint.y;this.angle=Math.atan2(i,t),this.dirX=Math.cos(this.angle),this.dirY=Math.sin(this.angle)}move(){this.startPoint.x=this.movement_speed*this.dirX+this.startPoint.x,this.startPoint.y=this.movement_speed*this.dirY+this.startPoint.y,(this.startPoint.x<0||this.startPoint.x>e.windowWidth||this.startPoint.y<0||this.startPoint.y>e.windowHeight)&&this.evaporate()}}class mt{constructor(){r(this,"charName");r(this,"startPoint");r(this,"movement_speed");r(this,"default_speed");r(this,"dirX");r(this,"dirY");r(this,"direction");r(this,"images_back");r(this,"images_front");r(this,"images_right");r(this,"images_left");r(this,"health");r(this,"stamina");r(this,"score");r(this,"time");r(this,"frameToShow");r(this,"isBlowingLantern");r(this,"isUsingMedkit");r(this,"frameTime");r(this,"currWeapon");r(this,"isAttacking");r(this,"isWalking");r(this,"isRunning");r(this,"abilityMode");r(this,"r");this.charName=B.character,this.startPoint=new o(0,0),this.movement_speed=nt,this.default_speed=this.movement_speed,this.dirX=0,this.dirY=0,this.direction="r",this.images_back=[],this.images_front=[],this.images_left=[],this.images_right=[],this.health=rt,this.stamina=lt,this.score=0,this.time=0,this.frameToShow=0,this.isBlowingLantern=!1,this.isUsingMedkit=!1,this.frameTime=4,this.currWeapon="axe",this.isAttacking=!1,this.isWalking=!1,this.isRunning=!1,this.abilityMode=!1,this.r=50}changeCharacter(t){this.charName=t,this.images_back=T[t].back,this.images_front=T[t].front,this.images_left=T[t].left,this.images_right=T[t].right}increaseSpeed(){this.stamina>1?(this.movement_speed=2*this.default_speed,this.isRunning=!0,d.run.audio.playbackRate=2,y(d.run,1),this.drainStamina()):(this.movement_speed=this.default_speed,this.isRunning=!1,y(d.iamtired,.01))}drainStamina(){this.stamina>0?this.stamina-=1:this.stamina=0}change_frames(){this.time>this.frameTime&&(this.frameToShow+=1,this.frameToShow==this.images_back.length&&(this.frameToShow=0),this.time=0),this.time++}show(t=e.ctx){let i=this.images_right[this.frameToShow];this.direction=="r"?i=this.images_right[this.frameToShow]:this.direction=="l"?i=this.images_left[this.frameToShow]:this.direction=="u"?i=this.images_back[this.frameToShow]:this.direction=="d"&&(i=this.images_front[this.frameToShow]),this.health>0&&(t.fillStyle="rgba(20, 20, 20,0.55)",t.beginPath(),t.ellipse(this.startPoint.x+20,this.startPoint.y+70,14,7,0,0,Math.PI*2),t.fill(),t.closePath(),this.direction=="d"&&t.drawImage(i,this.startPoint.x,this.startPoint.y),this.direction=="u"&&e.lantern.show(),this.currWeapon=="axe"&&e.axe.show(e.ctx,this.isAttacking),this.currWeapon=="gun"&&e.gun.show(e.ctx,this.isAttacking),this.direction!="d"&&t.drawImage(i,this.startPoint.x,this.startPoint.y),this.direction!="u"&&e.lantern.show())}move(){!this.isBlowingLantern&&!this.isUsingMedkit&&this.health>0&&(this.dirX!=0||this.dirY!=0)&&(this.isRunning||y(d.walk,1),e.bgImage.checkCollision(e.bgImage.startPoint.x+this.movement_speed*this.dirX,e.bgImage.startPoint.y+this.movement_speed*this.dirY)?y(d.collidedontosomething,.01):(e.bgImage.startPoint.x+e.adjustDeviceColliderX-e.windowWidth/2<0||(this.dirX>0&&(this.dirX=0),y(d.cantgobeyondthis,.01)),e.bgImage.startPoint.y+e.adjustDeviceColliderY-e.windowHeight/2>-e.bgImage.h||(this.dirY<0&&(this.dirY=0),y(d.cantgobeyondthis,.01)),e.bgImage.startPoint.y+e.adjustDeviceColliderY-e.windowHeight/2<0||(this.dirY>0&&(this.dirY=0),y(d.cantgobeyondthis,.01)),e.bgImage.startPoint.x+e.adjustDeviceColliderX-e.windowWidth/2>-e.bgImage.w||(this.dirX<0&&(this.dirX=0),y(d.cantgobeyondthis,.01)),e.enemiesArray.forEach(t=>{t.startPoint.x+=this.movement_speed*this.dirX,t.startPoint.y+=this.movement_speed*this.dirY}),e.pickupItemsArray.forEach(t=>{t.startPoint.x+=this.movement_speed*this.dirX,t.startPoint.y+=this.movement_speed*this.dirY}),e.fireProjectileArray.forEach(t=>{t.owner=="boss"&&(t.startPoint.x+=this.movement_speed*this.dirX,t.startPoint.y+=this.movement_speed*this.dirY)}),e.boss.startPoint.x+=this.movement_speed*this.dirX,e.boss.startPoint.y+=this.movement_speed*this.dirY,e.bgImage.startPoint.x+=this.movement_speed*this.dirX,e.bgImage.startPoint.y+=this.movement_speed*this.dirY,this.isWalking=!0,this.change_frames()))}increaseHealth(){e.player.health+=20,e.player.health>100&&(e.player.health=100),S.medKit--}useAbility(t){if(t=="light")if(e.inventory.abilities[0].cooldown==0){y(d.lightofblessings,1),y(d.lightsound,1),e.lantern.setLuminosity(),e.inventory.resetAbility(t);const i=setTimeout(()=>{e.lantern.resetLuminosity(),clearTimeout(i)},ht)}else e.inventory.displayMessage(e.ctx,"","Ability on Cooldown!"),y(d.notready,1);else if(t=="flame"&&e.inventory.abilities[1].cooldown==0){y(d.breathofdragon,1),y(d.flamesound,1),e.inventory.resetAbility(t);const i=new Ue(new o(e.player.startPoint.x+60,e.player.startPoint.y+20),e.player.direction,new o(e.mouseCoords.x,e.mouseCoords.y),"player");e.fireProjectileArray.push(i)}}}const me={"main-map.jpg":{colliders:[{x:745,y:-440,w:-525,h:-925,color:"blue"},{h:-925,w:-2045,x:-830,y:-445,color:"blue"},{x:-1530,y:450,w:-2045,h:-465,color:"blue"},{x:-495,y:-695,w:-650,h:-745,color:"blue"},{x:-515,y:-700,w:-670,h:-750,color:"blue"},{x:-690,y:-700,w:-855,h:-750,color:"blue"},{x:-550,y:-720,w:-615,h:-785,color:"blue"},{x:-745,y:-735,w:-810,h:-785,color:"blue"},{x:-505,y:-880,w:-565,h:-925,color:"blue"},{x:-500,y:-860,w:-570,h:-925,color:"blue"},{x:-790,y:-865,w:-865,h:-925,color:"blue"},{x:-315,y:-925,w:-460,h:-990,color:"blue"},{x:-275,y:-985,w:-370,h:-1020,color:"blue"},{x:-265,y:-965,w:-365,h:-1035,color:"blue"},{x:-855,y:-935,w:-935,h:-990,color:"blue"},{x:815,y:-420,w:715,h:-930,color:"blue"},{x:790,y:-930,w:710,h:-1005,color:"blue"},{x:450,y:-1145,w:295,h:-1280,color:"blue"},{x:465,y:-1150,w:295,h:-1275,color:"blue"},{x:640,y:-1140,w:555,h:-1220,color:"blue"},{x:500,y:-1280,w:440,h:-1315,color:"blue"},{x:510,y:-1280,w:450,h:-1345,color:"blue"},{x:515,y:-1265,w:435,h:-1355,color:"blue"},{x:660,y:-1155,w:625,h:-1210,color:"blue"},{x:660,y:-1140,w:630,h:-1225,color:"blue"},{x:150,y:-1170,w:85,h:-1250,color:"blue"},{x:55,y:-1225,w:-40,h:-1300,color:"blue"},{x:615,y:-1475,w:100,h:-1765,color:"blue"},{x:140,y:-1490,w:-45,h:-1720,color:"blue"},{x:655,y:-1520,w:575,h:-1710,color:"blue"},{x:-1025,y:-1305,w:-1145,h:-1385,color:"blue"},{x:-1220,y:-1300,w:-1335,h:-1380,color:"blue"},{x:-1550,y:-975,w:-1915,h:-1240,color:"blue"},{x:-1895,y:-1165,w:-2010,h:-1240,color:"blue"},{x:-1890,y:-940,w:-2095,h:-1080,color:"blue"},{x:-2130,y:-1320,w:-2245,h:-1400,color:"blue"},{x:-1990,y:-1405,w:-2045,h:-1480,color:"blue"},{x:-1420,y:-1705,w:-1475,h:-1765,color:"blue"},{x:-195,y:-1405,w:-295,h:-1485,color:"blue"},{x:-140,y:-1290,w:-240,h:-1370,color:"blue"},{x:160,y:-1170,w:115,h:-1250,color:"blue"},{x:805,y:-1215,w:650,h:-1320,color:"blue"},{x:810,y:-1235,w:655,h:-1355,color:"blue"},{x:805,y:-1225,w:655,h:-1275,color:"blue"},{x:650,y:-1265,w:550,h:-1350,color:"blue"},{x:545,y:-1340,w:460,h:-1405,color:"blue"},{x:-145,y:-1275,w:-255,h:-1340,color:"blue"},{x:-140,y:-1275,w:-250,h:-1310,color:"blue"},{x:-150,y:-1275,w:-250,h:-1305,color:"blue"},{x:535,y:-1320,w:485,h:-1365,color:"blue"},{x:-295,y:-1945,w:-410,h:-1975,color:"blue"},{x:-310,y:-1940,w:-410,h:-2040,color:"blue"},{x:-300,y:-1950,w:-350,h:-1975,color:"blue"},{x:-535,y:-1760,w:-695,h:-1855,color:"blue"},{x:735,y:-1365,w:650,h:-1435,color:"blue"},{x:-265,y:-2320,w:-325,h:-2395,color:"blue"},{x:-500,y:-1800,w:-575,h:-1865,color:"blue"},{x:-520,y:-1755,w:-705,h:-1840,color:"blue"},{x:-525,y:-1760,w:-690,h:-1835,color:"blue"},{x:-1275,y:-1910,w:-1460,h:-1985,color:"blue"},{x:-1330,y:-1965,w:-1410,h:-2025,color:"blue"},{x:-1305,y:-1950,w:-1345,h:-2e3,color:"blue"},{x:-1290,y:-1900,w:-1465,h:-1935,color:"blue"},{x:-1380,y:-1950,w:-1445,h:-2010,color:"blue"},{x:-670,y:-2045,w:-1550,h:-2090,color:"blue"},{x:-655,y:-2040,w:-1560,h:-2110,color:"blue"},{x:-2330,y:-1345,w:-2385,h:-1410,color:"blue"},{x:-2740,y:-1060,w:-3020,h:-1130,color:"blue"},{x:-2330,y:-1345,w:-2390,h:-1410,color:"blue"},{x:-2735,y:-1060,w:-3020,h:-1140,color:"blue"},{x:-2465,y:-670,w:-2585,h:-750,color:"blue"},{x:-2650,y:-410,w:-3070,h:-660,color:"blue"},{x:-2515,y:-420,w:-2685,h:-520,color:"blue"},{x:-2595,y:-485,w:-2690,h:-580,color:"blue"},{x:-3050,y:-570,w:-3115,h:-660,color:"blue"},{x:-3050,y:-415,w:-3155,h:-505,color:"blue"},{x:-1505,y:-2050,w:-1560,h:-2430,color:"blue"},{x:-1415,y:-2375,w:-1565,h:-2425,color:"blue"},{x:-1420,y:-2370,w:-1565,h:-2445,color:"blue"},{x:-805,y:-2085,w:-1380,h:-2345,color:"blue"},{x:-780,y:-2060,w:-830,h:-2335,color:"blue"},{x:-650,y:-2055,w:-700,h:-2375,color:"blue"},{x:-660,y:-2325,w:-775,h:-2395,color:"blue"},{x:-1315,y:-2310,w:-1385,h:-2360,color:"blue"},{x:80,y:460,w:-1200,h:315,color:"blue"},{x:-545,y:345,w:-810,h:265,color:"blue"},{x:-490,y:335,w:-560,h:280,color:"blue"},{x:-520,y:305,w:-565,h:285,color:"blue"},{x:-515,y:295,w:-560,h:285,color:"blue"},{x:-525,y:320,w:-570,h:275,color:"blue"},{x:200,y:460,w:45,h:415,color:"blue"},{x:175,y:460,w:55,h:400,color:"blue"},{x:165,y:430,w:45,h:360,color:"blue"},{x:140,y:400,w:60,h:345,color:"blue"},{x:125,y:380,w:65,h:340,color:"blue"},{x:115,y:375,w:45,h:305,color:"blue"},{x:-795,y:340,w:-855,h:280,color:"blue"},{x:-1190,y:470,w:-1315,h:405,color:"blue"},{x:-1190,y:435,w:-1230,h:350,color:"blue"},{x:-1230,y:440,w:-1270,h:395,color:"blue"},{x:-1215,y:445,w:-1265,h:375,color:"blue"},{x:-1180,y:395,w:-1225,h:345,color:"blue"},{x:-1225,y:395,w:-1260,h:380,color:"blue"},{x:-1715,y:-1940,w:-2640,h:-2030,color:"blue"},{x:-2040,y:-1920,w:-2400,h:-1980,color:"blue"},{x:-2580,y:-1965,w:-2650,h:-2400,color:"blue"},{x:-410,y:-2025,w:-605,h:-2095,color:"blue"},{x:-435,y:-2070,w:-585,h:-2150,color:"blue"},{x:-525,y:-2085,w:-680,h:-2195,color:"blue"},{x:-2025,y:-85,w:-2230,h:-190,color:"blue"},{x:-2065,y:-50,w:-2230,h:-100,color:"blue"},{x:-2415,y:450,w:-2680,h:340,color:"blue"},{x:-2555,y:410,w:-2650,h:325,color:"blue"},{x:-2610,y:355,w:-2680,h:245,color:"blue"},{x:-1697,y:-1962.5,w:-1757,h:-2432.5,color:"blue"},{x:-1702,y:-1967.5,w:-1767,h:-2432.5,color:"blue"},{x:-1707,y:-1952.5,w:-1762,h:-2447.5,color:"blue"},{x:-1762,y:-2102.5,w:-1897,h:-2217.5,color:"blue"},{x:-1762,y:-2087.5,w:-1897,h:-2222.5,color:"blue"},{x:-1917,y:-1992.5,w:-2092,h:-2107.5,color:"blue"},{x:-2062,y:-1942.5,w:-2197,h:-2167.5,color:"blue"},{x:-2082,y:-1982.5,w:-2392,h:-2072.5,color:"blue"},{x:-2042,y:-1997.5,w:-2077,h:-2172.5,color:"blue"},{x:-2227,y:-2017.5,w:-2387,h:-2162.5,color:"blue"},{x:-2437,y:-1992.5,w:-2612,h:-2102.5,color:"blue"},{x:-1747,y:-2367.5,w:-2252,h:-2442.5,color:"blue"},{x:-1762,y:-2302.5,w:-1862,h:-2367.5,color:"blue"},{x:-1747,y:-2292.5,w:-1852,h:-2377.5,color:"blue"},{x:-2467,y:-2372.5,w:-2782,h:-2432.5,color:"blue"},{x:-2632,y:-2337.5,w:-2797,h:-2397.5,color:"blue"},{x:-2657,y:-2467.5,w:-2732,h:-2542.5,color:"blue"},{x:-2187,y:-2452.5,w:-2237,h:-2527.5,color:"blue"},{x:-2457,y:-2477.5,w:-2542,h:-2572.5,color:"blue"},{x:-1082,y:-2457.5,w:-1142,h:-2532.5,color:"blue"},{x:-567,y:-2272.5,w:-627,h:-2337.5,color:"blue"},{x:-557,y:-2277.5,w:-657,h:-2352.5,color:"blue"},{x:-2672,y:-1267.5,w:-2852,h:-1352.5,color:"blue"},{x:-2957,y:-1252.5,w:-3142,h:-1332.5,color:"blue"},{x:-2992,y:-1332.5,w:-3112,h:-1367.5,color:"blue"},{x:-2992,y:-1302.5,w:-3102,h:-1372.5,color:"blue"},{x:-2857,y:-1307.5,w:-2957,h:-1362.5,color:"blue"},{x:-2857,y:-1307.5,w:-2962,h:-1377.5,color:"blue"},{x:-3322,y:-1847.5,w:-3842,h:-2152.5,color:"blue"},{x:-3322,y:-1847.5,w:-3697,h:-2157.5,color:"blue"},{x:-3262,y:-2017.5,w:-3362,h:-2097.5,color:"blue"},{x:-3227,y:-2057.5,w:-3302,h:-2122.5,color:"blue"},{x:-3262,y:-2002.5,w:-3342,h:-2042.5,color:"blue"},{x:-3662,y:-1892.5,w:-3842,h:-2147.5,color:"blue"},{x:778,y:-2212.5,w:628,h:-2337.5,color:"blue"},{x:783,y:-2217.5,w:598,h:-2327.5,color:"blue"},{x:798,y:-2342.5,w:533,h:-2522.5,color:"blue"},{x:708,y:-2282.5,w:603,h:-2427.5,color:"blue"},{x:808,y:-2397.5,w:518,h:-2522.5,color:"blue"},{x:803,y:-2402.5,w:538,h:-2512.5,color:"blue"},{x:803,y:-2562.5,w:358,h:-2632.5,color:"blue"},{x:408,y:-2577.5,w:353,h:-3027.5,color:"blue"},{x:468,y:-2947.5,w:358,h:-3027.5,color:"blue"},{x:403,y:-2997.5,w:358,h:-3052.5,color:"blue"},{x:783,y:-2582.5,w:623,h:-2872.5,color:"blue"},{x:793,y:-2607.5,w:443,h:-2767.5,color:"blue"},{x:613,y:-2637.5,w:448,h:-2877.5,color:"blue"},{x:683,y:-2732.5,w:563,h:-2797.5,color:"blue"},{x:673,y:-2722.5,w:563,h:-2822.5,color:"blue"},{x:658,y:-2782.5,w:573,h:-2847.5,color:"blue"},{x:-3657,y:-2347.5,w:-4052,h:-2657.5,color:"blue"},{x:-3762,y:-2612.5,w:-4047,h:-2722.5,color:"blue"},{x:-3752,y:-2632.5,w:-3787,h:-2717.5,color:"blue"},{x:-3617,y:-2522.5,w:-3682,h:-2612.5,color:"blue"},{x:-3147,y:-2707.5,w:-3207,h:-2782.5,color:"blue"},{x:-3122,y:-2882.5,w:-4047,h:-2972.5,color:"blue"},{x:-3137,y:-2937.5,w:-3317,h:-3082.5,color:"blue"},{x:-3127,y:-2907.5,w:-3327,h:-3087.5,color:"blue"},{x:-492,y:-3262.5,w:-677,h:-3342.5,color:"blue"},{x:-3332,y:-2992.5,w:-3502,h:-3242.5,color:"blue"},{x:-3342,y:-3197.5,w:-3502,h:-3267.5,color:"blue"},{x:-3512,y:-2977.5,w:-3682,h:-3257.5,color:"blue"},{x:-3422,y:-2987.5,w:-3532,h:-3222.5,color:"blue"},{x:-3432,y:-3162.5,w:-3587,h:-3207.5,color:"blue"},{x:-3442,y:-3162.5,w:-3542,h:-3222.5,color:"blue"},{x:-3447,y:-3177.5,w:-3552,h:-3222.5,color:"blue"},{x:-3437,y:-3182.5,w:-3557,h:-3242.5,color:"blue"},{x:-3687,y:-3082.5,w:-3932,h:-3317.5,color:"blue"},{x:-3087,y:-1697.5,w:-3167,h:-1797.5,color:"blue"},{x:-3217,y:-1707.5,w:-3327,h:-1797.5,color:"blue"},{x:123,y:-2467.5,w:53,h:-2542.5,color:"blue"},{x:528,y:-2127.5,w:438,h:-2187.5,color:"blue"},{x:528,y:-2112.5,w:433,h:-2192.5,color:"blue"},{x:-3092,y:-3267.5,w:-3162,h:-3352.5,color:"blue"},{x:-2172,y:-2952.5,w:-2642,h:-3352.5,color:"blue"},{x:-2022,y:-3012.5,w:-2202,h:-3187.5,color:"blue"},{x:-2132,y:-3197.5,w:-2197,h:-3337.5,color:"blue"},{x:-2222,y:-3317.5,w:-2352,h:-3392.5,color:"blue"},{x:-2327,y:-3317.5,w:-2427,h:-3502.5,color:"blue"},{x:-2317,y:-3332.5,w:-2637,h:-3497.5,color:"blue"},{x:-2607,y:-3042.5,w:-2717,h:-3312.5,color:"blue"},{x:-2592,y:-3052.5,w:-2692,h:-3282.5,color:"blue"},{x:-2607,y:-3237.5,w:-2667,h:-3292.5,color:"blue"},{x:-2662,y:-3157.5,w:-2742,h:-3217.5,color:"blue"},{x:-2667,y:-3067.5,w:-2717,h:-3122.5,color:"blue"},{x:-1167,y:-3267.5,w:-1342,h:-3342.5,color:"blue"},{x:-2612,y:-3497.5,w:-2677,h:-3537.5,color:"blue"},{x:-2602,y:-3487.5,w:-2682,h:-3542.5,color:"blue"},{x:-2707,y:-3482.5,w:-2772,h:-3537.5,color:"blue"},{x:-2797,y:-3477.5,w:-2877,h:-3532.5,color:"blue"},{x:-297,y:-3012.5,w:-497,h:-3087.5,color:"blue"},{x:-267,y:-3187.5,w:-457,h:-3262.5,color:"blue"},{x:-252,y:-3242.5,w:-337,h:-3327.5,color:"blue"},{x:-697,y:-3102.5,w:-797,h:-3192.5,color:"blue"},{x:-457,y:-3447.5,w:-552,h:-3527.5,color:"blue"},{x:-637,y:-3582.5,w:-747,h:-3662.5,color:"blue"},{x:-1602,y:-3442.5,w:-1707,h:-3527.5,color:"blue"},{x:-1587,y:-2957.5,w:-1777,h:-3047.5,color:"blue"},{x:-1177,y:-3012.5,w:-1372,h:-3092.5,color:"blue"},{x:-977,y:-3207.5,w:-1177,h:-3287.5,color:"blue"},{x:803,y:-3119.5,w:333,h:-3664.5,color:"blue"},{x:273,y:-3144.5,w:193,h:-3244.5,color:"blue"},{x:263,y:-3469.5,w:208,h:-3529.5,color:"blue"},{x:-1037,y:-3449.5,w:-1137,h:-3529.5,color:"blue"},{x:-1582,y:-3104.5,w:-1682,h:-3174.5,color:"blue"},{x:-2087,y:-2759.5,w:-2157,h:-2829.5,color:"blue"},{x:-542,y:-2759.5,w:-612,h:-2844.5,color:"blue"},{x:-3577,y:-1344.5,w:-3652,h:-1414.5,color:"blue"},{x:-3577,y:-1339.5,w:-3637,h:-1414.5,color:"blue"},{x:-3617,y:-1234.5,w:-3877,h:-1319.5,color:"blue"},{x:-2642,y:475.5,w:-3007,h:175.5,color:"blue"},{x:-2642,y:470.5,w:-4042,h:250.5,color:"blue"},{x:-2982,y:310.5,w:-4037,h:195.5,color:"blue"},{x:-3657,y:225.5,w:-4037,h:-289.5,color:"blue"},{x:-3612,y:-254.5,w:-3787,h:-364.5,color:"blue"},{x:-3717,y:-334.5,w:-3782,h:-399.5,color:"blue"},{x:-692,y:-3109.5,w:-797,h:-3179.5,color:"blue"},{x:-3857,y:-594.5,w:-3937,h:-734.5,color:"blue"},{x:-3857,y:-904.5,w:-3937,h:-1049.5,color:"blue"},{x:803,y:-254.5,w:408,h:-379.5,color:"blue"}],events:{doors:[{h:-2128,w:-2247,x:-2172,y:-2053,map:"house.png",other_pos:0,next_cor:{x:510-(1920-e.windowWidth)/2,y:-180-(922-e.windowHeight)/2}}]},depth:{path:'assets/maps/"main-map-depth.jpg"'},size:"native"},"house.png":{colliders:[{x:723,y:260.5,w:633,h:-344.5,color:"blue"},{x:688,y:265.5,w:233,h:130.5,color:"blue"},{x:708,y:255.5,w:233,h:105.5,color:"blue"},{x:578,y:165.5,w:233,h:30.5,color:"blue"},{x:583,y:190.5,w:233,h:35.5,color:"blue"},{x:308,y:380.5,w:43,h:220.5,color:"blue"},{x:93,y:340.5,w:8,h:-369.5,color:"blue"},{x:688,y:-89.5,w:503,h:-224.5,color:"blue"},{x:493,y:-99.5,w:328,h:-209.5,color:"blue"},{x:438,y:-179.5,w:368,h:-249.5,color:"blue"},{x:443,y:-179.5,w:328,h:-239.5,color:"blue"},{x:428,y:-214.5,w:338,h:-254.5,color:"blue"},{x:688,y:-314.5,w:338,h:-354.5,color:"blue"},{x:398,y:-214.5,w:333,h:-399.5,color:"blue"},{x:403,y:-229.5,w:328,h:-399.5,color:"blue"},{x:173,y:210.5,w:103,h:140.5,color:"blue"},{x:223,y:140.5,w:148,h:85.5,color:"blue"},{x:213,y:120.5,w:143,h:-34.5,color:"blue"},{x:218,y:90.5,w:108,h:-24.5,color:"blue"},{x:223,y:85.5,w:98,h:-34.5,color:"blue"},{x:268,y:20.5,w:193,h:-54.5,color:"blue"},{x:268,y:20.5,w:188,h:-44.5,color:"blue"},{x:118,y:60.5,w:58,h:.5,color:"blue"},{x:223,y:125.5,w:138,h:75.5,color:"blue"},{x:158,y:100.5,w:93,h:70.5,color:"blue"},{x:243,y:25.5,w:188,h:-14.5,color:"blue"},{x:313,y:-99.5,w:248,h:-334.5,color:"blue"},{x:298,y:-94.5,w:148,h:-219.5,color:"blue"},{x:138,y:-94.5,w:38,h:-219.5,color:"blue"},{x:173,y:-89.5,w:143,h:-164.5,color:"blue"},{x:178,y:-99.5,w:143,h:-199.5,color:"blue"},{x:128,y:-244.5,w:43,h:-309.5,color:"blue"},{x:133,y:-239.5,w:43,h:-299.5,color:"blue"},{x:133,y:-239.5,w:43,h:-314.5,color:"blue"},{x:258,y:-279.5,w:78,h:-309.5,color:"blue"},{x:268,y:-169.5,w:238,h:-309.5,color:"blue"},{x:263,y:-299.5,w:83,h:-309.5,color:"blue"},{x:268,y:-164.5,w:233,h:-354.5,color:"blue"}],events:{doors:[{x:355.5,y:-279.5,w:280.5,h:-339.5,map:"main-map.jpg",other_pos:1,next_cor:{x:-2020-(1920-e.windowWidth)/2,y:-2053-(922-e.windowHeight)/2}}]},depth:{path:'assets/maps/"house-depth.png"'},size:{width:850,height:850}}};class ut{constructor(t){r(this,"startPoint");r(this,"w");r(this,"h");r(this,"img");r(this,"depthImg");r(this,"name");r(this,"mapData");r(this,"otherMaps");r(this,"otherMapsDepth");this.startPoint=new o(-2220+e.adjustDeviceColliderX,-2220+e.adjustDeviceColliderY),this.w=4800,this.h=4080,this.name=t,this.img=new Image,this.depthImg=new Image,this.otherMaps=[],this.otherMapsDepth=[],this.mapData=me}initialiseImages(){this.img.src="./assets/maps/"+this.name,this.img.onload=u,this.otherMaps=[this.img],this.depthImg.src="./assets/maps/"+this.getDepthImgName(),this.depthImg.onload=u;let t=new Image;t.src="assets/maps/house.png",t.onload=u,this.otherMaps=[t],t=new Image,t.src="assets/maps/house-depth.png",t.onload=u,this.otherMapsDepth=[t],this.otherMaps.push(this.img),this.otherMapsDepth.push(this.depthImg)}getDepthImgName(){let t=this.name.split("."),i;return t.splice(1,0,"-depth."),i=t.join(""),i}show(t=e.ctx){if(t.clearRect(0,0,e.windowWidth,e.windowHeight),t.fillStyle="#181425",t.fillRect(0,0,e.windowWidth,e.windowHeight),this.checkEvents(),this.w==0&&this.h==0&&this.mapData[this.name].size=="native")t.drawImage(this.img,this.startPoint.x,this.startPoint.y);else{const i=this.mapData[this.name].size;i=="native"?t.drawImage(this.img,this.startPoint.x,this.startPoint.y):t.drawImage(this.img,this.startPoint.x,this.startPoint.y,i.width,i.height)}}showDepth(t=e.ctx){this.mapData[this.name].size=="native"?t.drawImage(this.depthImg,this.startPoint.x,this.startPoint.y):t.drawImage(this.depthImg,this.startPoint.x,this.startPoint.y,this.mapData[this.name].size.width,this.mapData[this.name].size.height)}checkEvents(t=this.startPoint.x,i=this.startPoint.y){this.mapData[this.name].events.doors.map(s=>{t-e.adjustDeviceColliderX<s.x&&t-e.adjustDeviceColliderX>s.w&&i-e.adjustDeviceColliderY<s.y&&i-e.adjustDeviceColliderY>s.h&&(this.startPoint.x=s.next_cor.x,this.startPoint.y=s.next_cor.y,this.name=s.map,this.img=this.otherMaps[s.other_pos],this.depthImg=this.otherMapsDepth[s.other_pos])})}checkCollision(t,i){let s=!1,n=this.mapData[this.name].colliders.length;for(let l=0;l<n;l++){let h=this.mapData[this.name].colliders[l];if(!e.debugCollider&&t-e.adjustDeviceColliderX<h.x&&t-e.adjustDeviceColliderX>h.w&&i-e.adjustDeviceColliderY<h.y&&i-e.adjustDeviceColliderY>h.h){s=!0;break}}return s}}const gt="/LF-SE-Fellowship-2024-Minor-Project-Eclipse-of-the-Lantern/assets/lantern/lantern-right.png",ue=new Image;ue.src=gt;ue.onload=u;const C={sprite:ue,width:55,height:74,position:[new o(30,30),new o(123,30),new o(230,30),new o(320,30),new o(430,30)]};class ft{constructor(){r(this,"x");r(this,"y");r(this,"img");r(this,"maxRadiusInnerCircle");r(this,"maxRadiusOuterCircle");r(this,"decreaseLuminosity");r(this,"setLuminosityInterval");r(this,"resetLuminosityInterval");r(this,"brightnessDecreaseRate");r(this,"spritePos");r(this,"r");r(this,"blowingLantern");this.decreaseLuminosity=null,this.setLuminosityInterval=null,this.resetLuminosityInterval=null,this.x=e.player.startPoint.x+15,this.y=e.player.startPoint.y+45,this.img=new Image,this.maxRadiusInnerCircle=ne,this.maxRadiusOuterCircle=Math.max(e.windowWidth,e.windowHeight)/2,this.brightnessDecreaseRate=je,this.spritePos=0,this.r=14,this.blowingLantern=null}show(t=e.ctx){if(e.player.isBlowingLantern?this.blowingLantern||(this.blowingLantern=setInterval(()=>{this.r<28?this.r+=1:(clearInterval(this.blowingLantern),this.blowingLantern=null)},100)):this.r=14,e.player.direction=="l"){t.fillStyle="rgba(255, 170, 51, 0.04)";for(let n=0;n<this.r;n++)L(t,this.x+10,this.y+20,n*3,n*3);const i=e.player.isRunning?5:8;let s=e.player.isWalking||e.player.isRunning?Math.floor(this.spritePos/i)%5:0;t.drawImage(C.sprite,C.position[s].x,C.position[s].y,C.width,C.height,this.x,this.y,25,30),(e.player.isWalking||e.player.isRunning)&&this.spritePos++}if(e.player.direction=="r"){t.fillStyle="rgba(255, 170, 51, 0.04)";for(let n=0;n<this.r;n++)L(t,this.x+5,this.y+20,n*3,n*3);const i=e.player.isRunning?5:8;let s=e.player.isWalking||e.player.isRunning?Math.floor(this.spritePos/i)%5:0;t.drawImage(C.sprite,C.position[s].x,C.position[s].y,C.width,C.height,this.x-5,this.y,25,30),(e.player.isWalking||e.player.isRunning)&&this.spritePos++}if(e.player.direction=="u"){t.fillStyle="rgba(255, 170, 51, 0.04)";for(let i=0;i<this.r;i++)L(t,this.x-5,this.y+10,i*3,i*3);t.drawImage(this.img,this.x-25,this.y-10,40,40)}if(e.player.direction=="d"){t.fillStyle="rgba(255, 170, 51, 0.04)";for(let i=0;i<this.r;i++)L(t,this.x-5,this.y+15,i*3,i*3);t.drawImage(this.img,this.x-25,this.y-10,40,40)}}showLuminosity(){const t=e.ctx.createRadialGradient(this.x+5,this.y+35,this.maxRadiusInnerCircle,this.x+5,this.y+35,this.maxRadiusOuterCircle);t.addColorStop(0,"rgba(0, 0, 0, 0)"),t.addColorStop(.1,"rgba(0, 0, 0, 0.8)"),t.addColorStop(.2,"rgba(0, 0, 0, 0.9)"),t.addColorStop(1,"rgba(0, 0, 0, 1)"),e.ctx.fillStyle=t,e.ctx.fillRect(0,0,c.width,c.height)}changeLuminosity(){this.decreaseLuminosity||(this.decreaseLuminosity=setInterval(()=>{this.maxRadiusInnerCircle<=0?(this.maxRadiusInnerCircle=0,clearInterval(this.decreaseLuminosity),this.decreaseLuminosity=null):e.gameState!=g.paused&&(this.maxRadiusInnerCircle-=this.brightnessDecreaseRate)},200))}resetLuminosity(){this.brightnessDecreaseRate=je,this.resetLuminosityInterval=setInterval(()=>{this.maxRadiusInnerCircle==ne?(clearInterval(this.resetLuminosityInterval),this.resetLuminosityInterval=null):this.maxRadiusInnerCircle>ne?this.maxRadiusInnerCircle-=1:this.maxRadiusInnerCircle<ne&&(this.maxRadiusInnerCircle+=1)},2)}setLuminosity(){this.brightnessDecreaseRate=0,this.setLuminosityInterval=setInterval(()=>{this.maxRadiusInnerCircle>=Math.max(c.width/2,c.height/2)?(this.maxRadiusInnerCircle=Math.max(c.width/2,c.height/2),clearInterval(this.setLuminosityInterval),this.setLuminosityInterval=null):this.maxRadiusInnerCircle+=1},2)}}const wt="/LF-SE-Fellowship-2024-Minor-Project-Eclipse-of-the-Lantern/assets/enemy/goblin/left/Png/GoblinBeastLeftAttack01.png",pt="/LF-SE-Fellowship-2024-Minor-Project-Eclipse-of-the-Lantern/assets/enemy/goblin/left/Png/GoblinBeastLeftDeath.png",bt="/LF-SE-Fellowship-2024-Minor-Project-Eclipse-of-the-Lantern/assets/enemy/goblin/right/Png/GoblinBeastRightAttack01.png",Pt="/LF-SE-Fellowship-2024-Minor-Project-Eclipse-of-the-Lantern/assets/enemy/goblin/right/Png/GoblinBeastRightDeath.png",xt="/LF-SE-Fellowship-2024-Minor-Project-Eclipse-of-the-Lantern/assets/enemy/goblin/front/Png/GoblinBeastDownAttack01.png",It="/LF-SE-Fellowship-2024-Minor-Project-Eclipse-of-the-Lantern/assets/enemy/goblin/front/Png/GoblinBeastDownDeath.png",St="/LF-SE-Fellowship-2024-Minor-Project-Eclipse-of-the-Lantern/assets/enemy/goblin/back/Png/GoblinBeastUpAttack01.png",At="/LF-SE-Fellowship-2024-Minor-Project-Eclipse-of-the-Lantern/assets/enemy/goblin/back/Png/GoblinBeastUpDeath.png",ge=new Image;ge.src=wt;ge.onload=u;const fe=new Image;fe.src=pt;fe.onload=u;const we=new Image;we.src=bt;we.onload=u;const pe=new Image;pe.src=Pt;pe.onload=u;const be=new Image;be.src=xt;be.onload=u;const Pe=new Image;Pe.src=It;Pe.onload=u;const xe=new Image;xe.src=St;xe.onload=u;const Ie=new Image;Ie.src=At;Ie.onload=u;const U={attackType1:{sprite:ge,height:48,width:48,position:[new o(20,16),new o(85,17),new o(146,17),new o(210,17),new o(270,16),new o(331,17),new o(398,17),new o(462,17)],offset:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}]},enemyDead:{sprite:fe,height:48,width:48,position:[new o(12,8),new o(63,12),new o(111,14),new o(147,30),new o(193,30),new o(243,30),new o(387,30),new o(435,30)],offset:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}]}},q={attackType1:{sprite:we,height:48,width:48,position:[new o(20,16),new o(82,17),new o(143,17),new o(206,17),new o(280,16),new o(350,17),new o(414,17),new o(470,17)],offset:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}]},enemyDead:{sprite:pe,height:48,width:48,position:[new o(12,8),new o(60,12),new o(108,14),new o(159,30),new o(207,30),new o(255,30),new o(399,30),new o(447,30)],offset:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}]}},G={attackType1:{sprite:be,height:48,width:48,position:[new o(20,16),new o(84,17),new o(145,17),new o(208,17),new o(272,23),new o(343,25),new o(402,25),new o(460,25)],offset:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}]},enemyDead:{sprite:Pe,height:48,width:48,position:[new o(12,8),new o(61,13),new o(109,15),new o(157,27),new o(205,27),new o(253,27),new o(397,27),new o(445,27)],offset:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}]}},K={attackType1:{sprite:xe,height:48,width:48,position:[new o(20,16),new o(84,17),new o(145,17),new o(208,17),new o(272,16),new o(343,9),new o(402,3),new o(460,0)],offset:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}]},enemyDead:{sprite:Ie,height:48,width:48,position:[new o(12,8),new o(61,13),new o(109,15),new o(157,27),new o(205,27),new o(253,27),new o(397,27),new o(445,27)],offset:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}]}};class vt{constructor(t,i){r(this,"startPoint");r(this,"images_back");r(this,"images_front");r(this,"images_left");r(this,"images_right");r(this,"MAX_HEALTH");r(this,"MIN_HEALTH");r(this,"damage");r(this,"health");r(this,"movement_speed");r(this,"finalX");r(this,"finalY");r(this,"direction");r(this,"time");r(this,"h");r(this,"w");r(this,"r");r(this,"default_movement_speed");r(this,"default_damage");r(this,"default_health");r(this,"damageTimeout");r(this,"isAttacking");r(this,"spritePos");r(this,"attackType");r(this,"isAlive");this.startPoint=new o(t,i),this.direction="d",this.h=R(80,100),this.w=this.h,this.r=40,this.MAX_HEALTH=5,this.MIN_HEALTH=2,this.default_damage=1,this.damage=this.default_damage,this.images_back=A.goblinImages.back,this.images_front=A.goblinImages.front,this.images_left=A.goblinImages.left,this.images_right=A.goblinImages.right,this.time=0,this.damageTimeout=null,this.default_health=Math.random()*(this.MAX_HEALTH-this.MIN_HEALTH)+this.MIN_HEALTH,this.health=this.default_health,this.default_movement_speed=1,this.movement_speed=Math.random()+this.default_movement_speed,this.finalX=e.player.startPoint.x,this.finalY=e.player.startPoint.y,this.isAttacking=!1,this.spritePos=0,this.attackType="attackType1",this.isAlive=!0}updateAttributes(){E(this.startPoint,e.player.startPoint)>e.lantern.maxRadiusInnerCircle*2?(this.movement_speed=this.default_movement_speed*2,this.damage=this.default_damage*2,this.health=this.health<this.default_health?this.health:this.default_health*2):(this.movement_speed=this.default_movement_speed,this.damage=this.default_damage)}determineDirection(){const t=ye(new o(this.finalX,this.finalY),this.startPoint)*(180/Math.PI);t>=-45&&t<45?this.direction="r":t>=45&&t<135?this.direction="d":t>=-135&&t<-45?this.direction="u":this.direction="l"}show(t=e.ctx){if(Math.floor(this.health)>0){if(this.isAttacking){let l=Math.floor(this.spritePos/5)%8;this.direction=="l"?t.drawImage(U[this.attackType].sprite,U[this.attackType].position[l].x-10,U[this.attackType].position[l].y-10,48,48,this.startPoint.x,this.startPoint.y,this.w,this.h):this.direction=="r"?t.drawImage(q[this.attackType].sprite,q[this.attackType].position[l].x-10,q[this.attackType].position[l].y-10,48,48,this.startPoint.x,this.startPoint.y,this.w,this.h):this.direction=="d"?t.drawImage(G[this.attackType].sprite,G[this.attackType].position[l].x-10,G[this.attackType].position[l].y-10,48,48,this.startPoint.x,this.startPoint.y,this.w,this.h):this.direction=="u"&&t.drawImage(K[this.attackType].sprite,K[this.attackType].position[l].x-10,K[this.attackType].position[l].y-10,48,48,this.startPoint.x,this.startPoint.y,this.w,this.h)}else if(!this.isAttacking){let l=Math.floor(this.spritePos/5)%this.images_right.length,h=this.images_right[l];this.direction=="r"?h=this.images_right[l]:this.direction=="l"?h=this.images_left[l]:this.direction=="u"?h=this.images_back[l]:this.direction=="d"&&(h=this.images_front[l]),this.startPoint.x>-100&&this.startPoint.x<e.windowWidth&&this.startPoint.y>-100&&this.startPoint.y<e.windowHeight&&t.drawImage(h,this.startPoint.x,this.startPoint.y,this.w,this.h)}this.spritePos++,t.fillStyle="rgba(20, 20, 20, 0.6)",t.beginPath();const i=this.w/3,s=this.h/10;t.ellipse(this.startPoint.x+this.w/2,this.startPoint.y+this.h-10,i,s,0,0,2*Math.PI),t.fill()}else{let s=Math.floor(this.spritePos/5)%8;this.direction=="l"?t.drawImage(U.enemyDead.sprite,U.enemyDead.position[s].x-10,U.enemyDead.position[s].y-10,48,48,this.startPoint.x,this.startPoint.y,this.w,this.h):this.direction=="r"?t.drawImage(q.enemyDead.sprite,q.enemyDead.position[s].x-10,q.enemyDead.position[s].y-10,48,48,this.startPoint.x,this.startPoint.y,this.w,this.h):this.direction=="d"?t.drawImage(G.enemyDead.sprite,G.enemyDead.position[s].x-10,G.enemyDead.position[s].y-10,48,48,this.startPoint.x,this.startPoint.y,this.w,this.h):this.direction=="u"&&t.drawImage(K.enemyDead.sprite,K.enemyDead.position[s].x-10,K.enemyDead.position[s].y-10,48,48,this.startPoint.x,this.startPoint.y,this.w,this.h),this.spritePos++,this.spritePos%40==0&&(this.isAlive=!1)}}move(){if(this.health>0){let t=E(e.player.startPoint,this.startPoint);if(t<dt||e.boss.hasRoar){let i=this.finalX-this.startPoint.x,s=this.finalY-this.startPoint.y,n=E(new o(this.finalX,this.finalY),this.startPoint);if(t>50){if(n>this.movement_speed){let l=this.movement_speed/n,h=l*i,f=l*s;e.bgImage.checkCollision(e.bgImage.startPoint.x-this.startPoint.x+this.finalX,e.bgImage.startPoint.y-this.startPoint.y+this.finalY+this.movement_speed)?this.startPoint.x=h+this.startPoint.x:e.bgImage.checkCollision(e.bgImage.startPoint.x-this.startPoint.x+this.finalX+this.movement_speed,e.bgImage.startPoint.y-this.startPoint.y+this.finalY)?this.startPoint.y=f+this.startPoint.y:(this.startPoint.x=h+this.startPoint.x,this.startPoint.y=f+this.startPoint.y),this.isAttacking=!1}}else{let l=Math.atan2(this.startPoint.y-e.player.startPoint.y,this.startPoint.x-e.player.startPoint.x),h=e.player.startPoint.x+Math.cos(l)*40,f=e.player.startPoint.y+Math.sin(l)*40,p=.05;this.startPoint.x+=(h-this.startPoint.x)*p,this.startPoint.y+=(f-this.startPoint.y)*p,this.isAttacking=!0,this.attack()}}}}attack(){e.player.health>0?(y(d.zombiegrunt,.001),this.damageTimeout||(this.damageTimeout=setTimeout(()=>{e.player.health-=this.damage,y(d.ithurts,.01),this.damageTimeout=null},500))):clearTimeout(this.damageTimeout)}separate(){let t=0,i=0;e.enemiesArray.forEach(s=>{if(this!=s){let n=this.startPoint.x-s.startPoint.x,l=this.startPoint.y-s.startPoint.y,h=Math.sqrt(n*n+l*l);if(h<40&&h>0){let f=(40-h)/40*20;t+=n/h*f,i+=l/h*f}}}),this.startPoint.x+=t,this.startPoint.y+=i}}class Se{constructor(t,i=5){r(this,"no_of_frames");r(this,"frameIndex");r(this,"time");r(this,"animation_speed");r(this,"frames_array");this.animation_speed=i,this.frames_array=t,this.no_of_frames=t.length,this.frameIndex=0,this.time=0}change_frames(){let t=this.animation_speed;this.time>t&&(this.frameIndex+=1,this.frameIndex==this.frames_array.length&&(this.frameIndex=0),this.time=0),this.time++}frame(){return this.frameIndex}}class Ne{constructor(){r(this,"slope");r(this,"startPoint");r(this,"c");this.slope=1,this.startPoint=new o(Math.floor(Math.random()*1920),Math.random()*1e3),this.c=this.startPoint.y-this.startPoint.x*this.slope}show(t=e.ctx){let i=Math.random()*100;t.strokeStyle="rgb(200, 200, 200)",t.beginPath(),t.moveTo(this.startPoint.x,this.startPoint.y),t.lineTo(this.generateX(this.startPoint.y+i),this.startPoint.y+i),t.stroke()}move(){this.startPoint.y=this.startPoint.y+Math.random()*30,this.startPoint.x=this.generateX(this.startPoint.y)}generateX(t){return(t-this.c)/this.slope}}class kt{constructor(){r(this,"healthImages");r(this,"overlayImages");r(this,"staminaImage");r(this,"healthBars");r(this,"staminaBars");r(this,"rainParticles");this.healthImages=[],this.staminaImage={},this.overlayImages=[],this.healthBars=5,this.staminaBars=5,this.rainParticles=[]}initialiseImages(t){const i=s=>{const n=new Image;return n.src=s,n.onload=u,n};this.healthImages[0]=i(`${t}/border.png`),this.healthImages[1]=i(`${t}/health.png`),this.staminaImage=i(`${t}/stamina.png`),this.healthImages[2]=i(`${t}/empty.png`),this.overlayImages[0]=i(`${t}/bloodOverlay.png`)}renderBloodOverlay(t=e.ctx){t.drawImage(this.overlayImages[0],0,0,e.windowWidth,e.windowHeight)}renderScore(t=e.ctx){t.font="40px Outfit",t.textAlign="right",t.fillStyle="white";const i=e.windowWidth-30;t.fillText(`Score: ${e.player.score}`,i,40)}renderHealth(t=e.ctx){e.player.health<30&&this.renderBloodOverlay(),t.font="14px Outfit",t.textAlign="left",t.fillStyle="white",t.fillText("Health",35,28);let i=0;for(let s=0;s<this.healthBars;s++)t.drawImage(this.healthImages[0],50+(s+1)*30+10,10,30,30),e.player.health>i?t.drawImage(this.healthImages[1],50+(s+1)*30+10,10,30,30):t.drawImage(this.healthImages[2],50+(s+1)*30+10,10,30,30),i+=100/this.healthBars}renderStamina(t=e.ctx){t.font="14px Outfit",t.textAlign="left",t.fillStyle="white",t.fillText("Stamina",300,28);let i=0;for(let s=0;s<this.staminaBars;s++)t.drawImage(this.healthImages[0],330+(s+1)*30+10,10,30,30),e.player.stamina>i?t.drawImage(this.staminaImage,330+(s+1)*30+10,10,30,30):t.drawImage(this.healthImages[2],330+(s+1)*30+10,10,30,30),i+=100/this.staminaBars;e.player.stamina<100&&(e.player.stamina+=.1)}initialiseRainParticles(){for(let t=0;t<200;t++)this.rainParticles[t]=new Ne}renderRainParticles(){let t=0;this.rainParticles.forEach(i=>{i.show(),i.move(),i.startPoint.y>1920&&(this.rainParticles[t]=new Ne),t+=1})}}class Tt{constructor(){r(this,"startPoint");r(this,"hoveredOption");r(this,"hoveredChar");r(this,"difficultyLevel");r(this,"selectedChar");r(this,"difficulties");r(this,"menuItems");r(this,"charItems");r(this,"charInfo");r(this,"characterImages");r(this,"tempHoverOption");this.startPoint=new o(e.windowWidth/15,150),this.hoveredOption=-1,this.hoveredChar=-1,this.difficultyLevel=0,this.selectedChar=0,this.tempHoverOption=0,this.difficulties=["GENOCIDE","HOMICIDE","SUICIDE"],this.menuItems=[{text:"Eclipse of the Lantern",fontSize:e.windowWidth/25,x:this.startPoint.x,y:this.startPoint.y+e.windowWidth/15*0,type:1},{text:"START JOURNEY",fontSize:e.windowWidth/25,x:this.startPoint.x,y:this.startPoint.y+e.windowWidth/20*2,type:0},{text:"CONTROLS",fontSize:e.windowWidth/25,x:this.startPoint.x,y:this.startPoint.y+e.windowWidth/20*3,type:0},{text:"ABOUT",fontSize:e.windowWidth/25,x:this.startPoint.x,y:this.startPoint.y+e.windowWidth/20*4,type:0},{text:"DIFFICULTY: ",fontSize:e.windowWidth/20,x:this.startPoint.x,y:this.startPoint.y+e.windowWidth/20*5,type:0}],this.charItems=[{text:"SELECT CHARACTER",x:e.windowWidth/1.5+100,y:380},{text:"<",x:e.windowWidth/1.5,y:480},{text:">",x:e.windowWidth/1.5+400,y:480}],this.characterImages=[],this.charInfo=[{name:"Ophelia"},{name:"Noah"}]}initialiseImages(){this.charInfo.forEach(t=>{const i=new Image;i.src=`assets/character/images/characters/profile/${t.name}.png`,i.onload=u,this.characterImages.push(i)})}updateMenuItems(){e.gameState==g.menuScreen?(this.menuItems=[{text:"Eclipse of the Lantern",fontSize:e.windowWidth/25,x:this.startPoint.x,y:this.startPoint.y+e.windowWidth/15*0,type:1},{text:"START JOURNEY",fontSize:e.windowWidth/25,x:this.startPoint.x,y:this.startPoint.y+e.windowWidth/20*2,type:0},{text:"CONTROLS",fontSize:e.windowWidth/25,x:this.startPoint.x,y:this.startPoint.y+e.windowWidth/20*3,type:0},{text:"ABOUT",fontSize:e.windowWidth/25,x:this.startPoint.x,y:this.startPoint.y+e.windowWidth/20*4,type:0},{text:"DIFFICULTY: ",fontSize:e.windowWidth/20,x:this.startPoint.x,y:this.startPoint.y+e.windowWidth/20*5,type:0}],this.charItems=[{text:"SELECT CHARACTER",x:e.windowWidth/1.5+100,y:380},{text:"<",x:e.windowWidth/1.5,y:480},{text:">",x:e.windowWidth/1.5+400,y:480}]):e.gameState==g.paused?(this.menuItems=[{text:"Eclipse of the Lantern",fontSize:e.windowWidth/25,x:this.startPoint.x,y:this.startPoint.y+e.windowWidth/15*0,type:1},{text:"RESUME",fontSize:e.windowWidth/25,x:this.startPoint.x,y:this.startPoint.y+e.windowWidth/20*2,type:0},{text:"CONTROLS",fontSize:e.windowWidth/25,x:this.startPoint.x,y:this.startPoint.y+e.windowWidth/20*3,type:0},{text:"ABOUT",fontSize:e.windowWidth/25,x:this.startPoint.x,y:this.startPoint.y+e.windowWidth/20*4,type:0},{text:"QUIT",fontSize:e.windowWidth/20,x:this.startPoint.x,y:this.startPoint.y+e.windowWidth/20*5,type:0}],this.charItems=[]):e.gameState==g.retryScreen?(this.menuItems=[{text:"Eclipse of the Lantern",fontSize:e.windowWidth/25,x:this.startPoint.x,y:this.startPoint.y+e.windowWidth/15*0,type:1},{text:"RETRY",fontSize:e.windowWidth/25,x:this.startPoint.x,y:this.startPoint.y+e.windowWidth/20*2,type:0},{text:"CONTROLS",fontSize:e.windowWidth/25,x:this.startPoint.x,y:this.startPoint.y+e.windowWidth/20*3,type:0},{text:"ABOUT",fontSize:e.windowWidth/25,x:this.startPoint.x,y:this.startPoint.y+e.windowWidth/20*4,type:0},{text:"QUIT",fontSize:e.windowWidth/20,x:this.startPoint.x,y:this.startPoint.y+e.windowWidth/20*5,type:0}],this.charItems=[]):e.gameState==g.gameFinish&&(this.menuItems=[{text:"Eclipse of the Lantern",fontSize:e.windowWidth/25,x:this.startPoint.x,y:this.startPoint.y+e.windowWidth/15*0,type:1},{text:"CONGRATULATIONS! You conquered the enemies.",fontSize:e.windowWidth/25,x:this.startPoint.x,y:this.startPoint.y+e.windowWidth/20*2,type:0},{text:"ABOUT",fontSize:e.windowWidth/25,x:this.startPoint.x,y:this.startPoint.y+e.windowWidth/20*3,type:0},{text:"QUIT",fontSize:e.windowWidth/20,x:this.startPoint.x,y:this.startPoint.y+e.windowWidth/20*4,type:0}],this.charItems=[])}show(t=e.ctx){this.updateMenuItems(),t.fillStyle="rgba(0, 0, 0, 0.74)",t.fillRect(0,0,e.windowWidth,e.windowHeight),t.textAlign="left",t.font="30px Nos";let i=0,s=!0,n=e.mouseCoords.x,l=e.mouseCoords.y;this.menuItems.forEach(h=>{t.font=`${h.fontSize}px Nos`,t.fillStyle="rgb(255, 255, 255)";let f=!1;n>=h.x&&n<h.x+h.text.length/1.5*h.fontSize&&l<=h.y&&l>h.y-h.fontSize&&(f=!0,this.tempHoverOption!=this.hoveredOption&&y(d.optionhover,1),this.tempHoverOption=this.hoveredOption,this.hoveredOption=i,s=!1),h.type==1||f?i>0&&(t.font="30px stat",t.fillStyle="red"):(t.font="30px stat",t.fillStyle="rgb(255, 255, 255)"),e.gameState==g.menuScreen&&i==4?t.fillText(h.text+this.difficulties[this.difficultyLevel],h.x,h.y):t.fillText(h.text,h.x,h.y),i++}),e.gameState==g.menuScreen&&(s&&(this.hoveredOption=-1),s=!0,i=0,this.charItems.forEach(h=>{t.fillStyle="rgb(255, 255, 255)",n>=h.x&&n<h.x+50&&l<=h.y&&l>h.y-50&&(t.fillStyle="red",y(d.optionhover,1),s=!1,this.hoveredChar=i),t.fillText(h.text,h.x,h.y),i++}),s&&(this.hoveredChar=-1),t.drawImage(this.characterImages[this.selectedChar],e.windowWidth/1.5+140,500,100,100),t.font="40px stat",t.textAlign="center",t.fillStyle="rgb(255, 255, 255)",t.fillText(this.charInfo[this.selectedChar].name,e.windowWidth/1.5+200,450,500),t.font="20px stat")}handleSelect(){e.gameState==g.menuScreen?((this.hoveredChar==1||this.hoveredChar==2)&&(y(d.optionclick,1),this.selectedChar=this.selectedChar==0?1:0),this.hoveredOption==4&&(y(d.optionclick,1),this.difficultyLevel<this.difficulties.length-1?this.difficultyLevel++:this.difficultyLevel=0)):this.hoveredOption==4&&(y(d.optionclick,1),e.gameState=g.menuScreen),e.gameState!=g.gameFinish&&(this.hoveredOption==1&&(y(d.optionclick,1),B.difficultyLevel=this.difficultyLevel,B.character=this.charInfo[this.selectedChar].name,e.gameState==g.paused?di():ai()),this.hoveredOption==2&&(e.tempGameState=e.gameState,e.gameState=g.controlsScreen),this.hoveredOption==3&&(e.tempGameState=e.gameState,e.gameState=g.aboutScreen))}}const _t="/LF-SE-Fellowship-2024-Minor-Project-Eclipse-of-the-Lantern/assets/pickups/fuel/fuel.png",Ae=new Image;Ae.src=_t;Ae.onload=u;const ae={sprite:Ae,width:24,height:25,position:[new o(0,0),new o(24,0),new o(48,0),new o(72,0),new o(96,0),new o(120,0),new o(144,0),new o(168,0)]};class Et{constructor(t,i,s){r(this,"images");r(this,"startPoint");r(this,"isUsed");r(this,"type");r(this,"spritePos");this.images=A.pickupItems.medkit,this.startPoint=new o(t,i),this.isUsed=!1,this.type=s,this.spritePos=0}show(t,i,s=e.ctx){const n=this.startPoint.x,l=this.startPoint.y;let h=n+16,f=l+40,p=i+10,P=i+5;if(this.type.itemName=="fuel"){let w=Math.floor(this.spritePos/5)%8;s.drawImage(ae.sprite,ae.position[w].x,ae.position[w].y,ae.width,ae.height,n,l,30,30),this.spritePos++}else if(this.type.itemName=="health_pack")h=n+30,f=l+50,p=i+14,P=i+4,s.drawImage(t,n,l,60,60);else if(this.type.itemName=="ammo"){p=i+22;const m=ce.ammo;s.drawImage(m,n,l,30,30)}s.fillStyle="rgba(20, 20, 20, 150)",s.beginPath(),s.ellipse(h,f,p/2,P/2,0,0,Math.PI*2),s.fill()}collect(){E(this.startPoint,e.player.startPoint)<50&&(this.type.itemName=="health_pack"?(y(d.medkitpickup,1),setTimeout(()=>{y(d.foundmedkits,.5)},500),S.medKit++):this.type.itemName=="fuel"?(y(d.fuelpickup,1),setTimeout(()=>{y(d.foundfuel,.5)},500),S.fuel++):this.type.itemName=="ammo"&&(y(d.ammopickup,1),setTimeout(()=>{y(d.moreammo,.5)},500),S.ammo+=50),this.isUsed=!0)}}class Lt{constructor(){r(this,"fuelImg");r(this,"medKitImg");r(this,"ammoImg");r(this,"abilities");r(this,"showMessage");r(this,"message");r(this,"item");this.fuelImg={},this.medKitImg={},this.ammoImg={},this.abilities=[{name:"Light of Blessings",src:"assets/abilities/light.png",maxCooldown:30,cooldown:0,cooldownInterval:0},{name:"Breath of Dragon",src:"assets/abilities/flame.png",maxCooldown:20,cooldown:0,cooldownInterval:0}],this.showMessage=!1,this.message="",this.item=""}initialiseImages(){const t=i=>{const s=new Image;return s.src=i,s.onload=u,s};this.fuelImg=t("./assets/inventory/fuel.png"),this.medKitImg=t("./assets/inventory/medkit.png"),this.ammoImg=t("./assets/inventory/ammo.png")}show(t=e.ctx){t.font="18px Outfit",t.textAlign="right",t.fillStyle="white",t.fillText("Items",80,100),t.textAlign="center",t.fillStyle="white",t.font="16px Outfit",t.drawImage(this.medKitImg,30,120,40,40),t.fillText(`x ${S.medKit}`,100,145,100),t.drawImage(this.fuelImg,30,180,40,40),t.fillText(`x ${S.fuel}`,100,210,100),t.drawImage(this.ammoImg,30,240,40,40),t.fillText(`x ${S.ammo}`,100,265,100),this.displayWeapons(),this.displayAbilities(),this.displayMessage(t)}displayMessage(t=e.ctx,i,s){(i||s||this.showMessage)&&(this.showMessage=!0,s&&(this.message=s),i&&(this.item=i),t.textAlign="center",t.fillStyle="white",t.font="24px Outfit",this.item=="health_pack"&&(t.fillText("Out of Med Kit!",c.width/2,c.height-50,400),y(d.outofmedkit,1)),this.item=="fuel"&&(t.fillText("Out of Fuel!",c.width/2,c.height-50,400),y(d.outoffuel,1)),this.item=="ammo"&&(t.fillText("Out of Ammo!",c.width/2,c.height-50,400),y(d.outofammo,1)),this.message&&t.fillText(this.message,c.width/2,c.height-50,400),setTimeout(()=>{this.showMessage=!1,this.message="",this.item=""},1e3))}displayWeapons(t=e.ctx){t.font="18px Outfit",t.textAlign="left",t.fillStyle="white",t.fillText("Weapons",30,320);const i=30,s="#333";let n=30;const l=350;t.strokeStyle=s,t.lineWidth=2,t.strokeRect(n,l,i,i),e.player.currWeapon=="axe"&&(t.strokeStyle="aqua",t.lineWidth=2,t.strokeRect(n-2,l-2,i+4,i+4));const h=ie.axe;t.drawImage(h,n,l,i,i),n=80,t.strokeStyle=s,t.lineWidth=2,t.strokeRect(n,l,i,i),e.player.currWeapon=="gun"&&(t.strokeStyle="aqua",t.lineWidth=2,t.strokeRect(n-2,l-2,i+4,i+4));const f=ie.gun;t.drawImage(f,n,l,i,i)}displayAbilities(t=e.ctx){const s="#333",n=e.windowWidth-215;t.font="18px Outfit",t.textAlign="left",t.fillStyle="white",t.fillText("Abilities",n,120);for(let[l,h]of this.abilities.entries()){const f=h.cooldown,p=h.maxCooldown;let P=150+l*70;t.strokeStyle=s,t.lineWidth=2,t.strokeRect(n,P,40,40);const m=h.name=="Light of Blessings"?se.light:se.flame;t.drawImage(m,n,P,40,40),t.font="14px Outfit",t.textAlign="right",t.fillStyle="white",t.fillText(h.name,e.windowWidth-40,P+25),f>0&&(t.fillStyle="rgba(0, 0, 0, 0.6)",t.fillRect(n+1,P+40/p*(p-f)+2,38,40-40/p*(p-f)-2),t.fillStyle="white",t.font="16px Outfit",t.textAlign="center",t.textBaseline="middle",t.fillText(`${f}s`,n+40/2,P+40/2),h.cooldownInterval||(h.cooldownInterval=setInterval(()=>{h.cooldown>0&&e.gameState!=g.paused&&h.cooldown--},1e3)))}}resetAbility(t){t=="light"&&(this.abilities[0].cooldown=this.abilities[0].maxCooldown),t=="flame"&&(this.abilities[1].cooldown=this.abilities[1].maxCooldown)}}const Ct="/LF-SE-Fellowship-2024-Minor-Project-Eclipse-of-the-Lantern/assets/weapons/axe-left/axe-left.png",Mt="/LF-SE-Fellowship-2024-Minor-Project-Eclipse-of-the-Lantern/assets/weapons/axe-right/axe-right.png",Rt="/LF-SE-Fellowship-2024-Minor-Project-Eclipse-of-the-Lantern/assets/weapons/axe-back/back.png",Dt="/LF-SE-Fellowship-2024-Minor-Project-Eclipse-of-the-Lantern/assets/weapons/axe-front/front.png",ve=new Image;ve.src=Ct;ve.onload=u;const ke=new Image;ke.src=Mt;ke.onload=u;const Te=new Image;Te.src=Rt;Te.onload=u;const _e=new Image;_e.src=Dt;_e.onload=u;const O={sprite:ve,height:54,position:[new o(0,0),new o(77,0),new o(141,0),new o(228,0),new o(312,0),new o(392,0),new o(487,0),new o(564,0)],offset:[{x:12,y:10},{x:0,y:10},{x:-24,y:18},{x:-24,y:32},{x:-28,y:44},{x:-26,y:32},{x:-24,y:18},{x:12,y:10}],width:[32,30,49,51,38,49,30,32]},Y={sprite:ke,height:54,position:[new o(0,0),new o(77,0),new o(155,0),new o(245,0),new o(317,0),new o(411,0),new o(487,0),new o(564,0)],offset:[{x:-25,y:10},{x:10,y:10},{x:20,y:28},{x:20,y:44},{x:20,y:28},{x:20,y:20},{x:-12,y:10},{x:-24,y:10}],width:[32,30,49,51,50,60,30,32]},X={sprite:_e,height:50,position:[new o(0,0),new o(26,0),new o(37,0)],offset:[{x:28,y:8},{x:28,y:8},{x:28,y:8}],width:[9,9,9]},j={sprite:Te,height:50,position:[new o(1,0),new o(34,0),new o(47,0)],offset:[{x:30,y:10},{x:30,y:10},{x:30,y:10}],width:[8,8,8]};class Ft{constructor(){r(this,"startPoint");r(this,"r");r(this,"spritePos");r(this,"shockPoint");this.startPoint=e.player.startPoint,this.r=50,this.spritePos=0,this.shockPoint=new o(0,0)}show(t=e.ctx,i){if(e.player.direction=="r"){let n=i?Math.floor(this.spritePos/5)%8:0;t.drawImage(Y.sprite,Y.position[n].x,Y.position[n].y,Y.width[n],Y.height,e.player.startPoint.x+Y.offset[n].x,e.player.startPoint.y+Y.offset[n].y,_,_),i&&(this.spritePos++,this.spritePos%40==0&&(e.player.isAttacking=!1))}else if(e.player.direction=="l"){let n=i?Math.floor(this.spritePos/5)%8:0;t.drawImage(O.sprite,O.position[n].x,O.position[n].y,O.width[n],O.height,e.player.startPoint.x+O.offset[n].x,e.player.startPoint.y+O.offset[n].y,_,_),i&&(this.spritePos++,this.spritePos%40==0&&(e.player.isAttacking=!1))}else if(e.player.direction=="u"){let n=i?Math.floor(this.spritePos/14)%3:0;t.drawImage(j.sprite,j.position[n].x,j.position[n].y,j.width[n],j.height,e.player.startPoint.x+j.offset[n].x,e.player.startPoint.y+j.offset[n].y,8,_),i&&(this.spritePos++,this.spritePos%42==0&&(e.player.isAttacking=!1))}else if(e.player.direction=="d"){let n=i?Math.floor(this.spritePos/14)%3:0;t.drawImage(X.sprite,X.position[n].x,X.position[n].y,X.width[n],X.height,e.player.startPoint.x+X.offset[n].x,e.player.startPoint.y+X.offset[n].y,8,_),i&&(this.spritePos++,this.spritePos%42==0&&(e.player.isAttacking=!1))}t.fillStyle="rgba(20, 20, 20,0.55)",t.beginPath(),t.ellipse(this.shockPoint.x,this.shockPoint.y,10,10,0,0,Math.PI*2),t.fill(),t.closePath()}calculateShockPoint(){const t=Math.atan2(e.mouseCoords.y-e.player.startPoint.y,e.mouseCoords.x-e.player.startPoint.x),i=Math.sin(t)*this.r,s=Math.cos(t)*this.r;this.shockPoint=new o(this.startPoint.x+s+20,this.startPoint.y+i+50)}hits(t){return E(new o(this.shockPoint.x,this.shockPoint.y),new o(t.startPoint.x+t.w/2,t.startPoint.y+t.h/2))<this.r}}const Wt="/LF-SE-Fellowship-2024-Minor-Project-Eclipse-of-the-Lantern/assets/weapons/gun-left/gun-left.png",Ht="/LF-SE-Fellowship-2024-Minor-Project-Eclipse-of-the-Lantern/assets/weapons/gun-right/gun-right.png",Bt="/LF-SE-Fellowship-2024-Minor-Project-Eclipse-of-the-Lantern/assets/weapons/gun-back/gun-back.png",Ot="/LF-SE-Fellowship-2024-Minor-Project-Eclipse-of-the-Lantern/assets/weapons/gun-front/gun-front.png",Ee=new Image;Ee.src=Wt;Ee.onload=u;const Le=new Image;Le.src=Ht;Le.onload=u;const Ce=new Image;Ce.src=Bt;Ce.onload=u;const Me=new Image;Me.src=Ot;Me.onload=u;const k={sprite:Ee,height:65,position:[new o(0,0),new o(136,0),new o(274,0),new o(408,0)],offset:[{x:-8,y:24},{x:-8,y:20},{x:-8,y:22},{x:-8,y:24}],width:[116,116,110,116]},D={sprite:Le,height:65,position:[new o(0,0),new o(137,0),new o(270,0),new o(408,0)],offset:[{x:-4,y:24},{x:-4,y:20},{x:-4,y:22},{x:-4,y:24}],width:[116,110,116,116]},N={sprite:Me,height:28,position:[new o(3,0),new o(50,0),new o(99,0),new o(144,0)],offset:[{x:32,y:14},{x:32,y:14},{x:32,y:14},{x:32,y:14}],width:[19,20,18,19]},$={sprite:Ce,height:28,position:[new o(1,0),new o(41,0),new o(88,0),new o(127,0)],offset:[{x:32,y:10},{x:32,y:10},{x:32,y:10},{x:32,y:10}],width:[22,26,20,20]};class Yt{constructor(t,i,s){r(this,"startPoint");r(this,"initialX");r(this,"initialY");r(this,"r");r(this,"endPoint");r(this,"movement_speed");r(this,"dir");r(this,"toDelete");this.startPoint=new o(t.x-30,t.y+30),this.dir=i,this.initialX=this.startPoint.x,this.initialY=this.startPoint.y,this.r=5,this.endPoint=new o(s.x*1.05,s.y*1.05),this.movement_speed=20,this.toDelete=!1}show(t=e.ctx){t.strokeStyle="none",t.fillStyle="rgb(255, 255, 100)",L(t,this.startPoint.x,this.startPoint.y,this.r*1.5,this.r*1.5),t.fillStyle="rgba(255, 170, 51, 0.016)";for(let i=0;i<this.r*4;i++)L(t,this.initialX-10,this.initialY,i*3,i*3);t.save(),t.translate(this.startPoint.x,this.startPoint.y),t.rotate(Math.atan2(this.startPoint.y-this.endPoint.y,this.startPoint.x-this.endPoint.x));for(let i=0;i<this.r*4;i++)L(t,0,0,i*5,i);t.restore()}hits(t){return E(new o(this.startPoint.x-100,this.startPoint.y-130),new o(t.startPoint.x-50,t.startPoint.y-50))<this.r+t.r}evaporate(){this.toDelete=!0}move(){let t=this.endPoint.x-this.startPoint.x,i=this.endPoint.y-this.startPoint.y,s=E(this.endPoint,this.startPoint);if(s>this.movement_speed){let n=this.movement_speed/s,l=n*t,h=n*i;this.startPoint.x=l+this.startPoint.x,this.startPoint.y=h+this.startPoint.y}else this.startPoint.x=this.endPoint.x,this.startPoint.y=this.endPoint.y,this.evaporate()}}class Xt{constructor(){r(this,"startPoint");r(this,"spritePos");this.startPoint=e.player.startPoint,this.spritePos=0}show(t=e.ctx,i){if(e.player.direction=="r"){let n=i?Math.floor(this.spritePos/5)%4:0;if(t.drawImage(D.sprite,D.position[n].x,D.position[n].y,D.width[n],D.height,e.player.startPoint.x+D.offset[n].x,e.player.startPoint.y+D.offset[n].y,_,_),i){t.fillStyle="rgba(255, 170, 51, 0.04)";for(let l=0;l<14;l++)L(t,e.player.startPoint.x+D.offset[n].x+50,e.player.startPoint.y+D.offset[n].y+20,l*3,l*3);this.spritePos++,this.spritePos%20==0&&(e.player.isAttacking=!1)}}else if(e.player.direction=="l"){let n=i?Math.floor(this.spritePos/5)%4:0;if(t.drawImage(k.sprite,k.position[n].x,k.position[n].y,k.width[n],k.height,e.player.startPoint.x+k.offset[n].x,e.player.startPoint.y+k.offset[n].y,_,_),i){t.fillStyle="rgba(255, 170, 51, 0.04)";for(let l=0;l<14;l++)L(t,e.player.startPoint.x+k.offset[n].x,e.player.startPoint.y+k.offset[n].y+20,l*3,l*3);this.spritePos++,this.spritePos%20==0&&(e.player.isAttacking=!1)}}else if(e.player.direction=="u"){let n=i?Math.floor(this.spritePos/5)%4:0;if(t.drawImage($.sprite,$.position[n].x,$.position[n].y,$.width[n],$.height,e.player.startPoint.x+$.offset[n].x,e.player.startPoint.y+$.offset[n].y,8,_),i){t.fillStyle="rgba(255, 170, 51, 0.04)";for(let l=0;l<14;l++)L(t,e.player.startPoint.x+k.offset[n].x+45,e.player.startPoint.y+k.offset[n].y,l*3,l*3);this.spritePos++,this.spritePos%20==0&&(e.player.isAttacking=!1)}}else if(e.player.direction=="d"){let n=i?Math.floor(this.spritePos/5)%4:0;if(t.drawImage(N.sprite,N.position[n].x,N.position[n].y,N.width[n],N.height,e.player.startPoint.x+N.offset[n].x,e.player.startPoint.y+N.offset[n].y,8,_),i){t.fillStyle="rgba(255, 170, 51, 0.04)";for(let l=0;l<14;l++)L(t,e.player.startPoint.x+k.offset[n].x+45,e.player.startPoint.y+k.offset[n].y+10,l*3,l*3);this.spritePos++,this.spritePos%20==0&&(e.player.isAttacking=!1)}}}fire(){const t=ye(new o(e.mouseCoords.x,e.mouseCoords.y),e.player.startPoint)*(180/Math.PI);t>=-45&&t<45?e.player.direction="r":t>=45&&t<135?e.player.direction="d":t>=-135&&t<-45?e.player.direction="u":e.player.direction="l";const i=new Yt(new o(e.player.startPoint.x+60,e.player.startPoint.y+20),e.player.direction,new o(e.mouseCoords.x,e.mouseCoords.y));e.bulletProjectileArray.push(i),S.ammo--}}const jt="/LF-SE-Fellowship-2024-Minor-Project-Eclipse-of-the-Lantern/assets/boss/left/Png/GoblinBeastLeftAttack01.png",Nt="/LF-SE-Fellowship-2024-Minor-Project-Eclipse-of-the-Lantern/assets/boss/left/Png/GoblinBeastLeftDeath.png",$t="/LF-SE-Fellowship-2024-Minor-Project-Eclipse-of-the-Lantern/assets/boss/right/Png/GoblinBeastRightAttack01.png",zt="/LF-SE-Fellowship-2024-Minor-Project-Eclipse-of-the-Lantern/assets/boss/right/Png/GoblinBeastRightDeath.png",Ut="/LF-SE-Fellowship-2024-Minor-Project-Eclipse-of-the-Lantern/assets/boss/front/Png/GoblinBeastDownAttack01.png",qt="/LF-SE-Fellowship-2024-Minor-Project-Eclipse-of-the-Lantern/assets/boss/front/Png/GoblinBeastDownDeath.png",Gt="/LF-SE-Fellowship-2024-Minor-Project-Eclipse-of-the-Lantern/assets/boss/back/Png/GoblinBeastUpAttack01.png",Kt="/LF-SE-Fellowship-2024-Minor-Project-Eclipse-of-the-Lantern/assets/boss/back/Png/GoblinBeastUpDeath.png",Re=new Image;Re.src=jt;Re.onload=u;const De=new Image;De.src=Nt;De.onload=u;const Fe=new Image;Fe.src=$t;Fe.onload=u;const We=new Image;We.src=zt;We.onload=u;const He=new Image;He.src=Ut;He.onload=u;const Be=new Image;Be.src=qt;Be.onload=u;const Oe=new Image;Oe.src=Gt;Oe.onload=u;const Ye=new Image;Ye.src=Kt;Ye.onload=u;const Q={attackType1:{sprite:Re,height:48,width:48,position:[new o(20,16),new o(85,17),new o(146,17),new o(210,17),new o(270,16),new o(331,17),new o(398,17),new o(462,17)],offset:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}]},enemyDead:{sprite:De,height:48,width:48,position:[new o(12,8),new o(63,12),new o(111,14),new o(147,30),new o(193,30),new o(243,30),new o(387,30),new o(435,30)],offset:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}]}},V={attackType1:{sprite:Fe,height:48,width:48,position:[new o(20,16),new o(82,17),new o(143,17),new o(206,17),new o(280,16),new o(350,17),new o(414,17),new o(470,17)],offset:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}]},enemyDead:{sprite:We,height:48,width:48,position:[new o(12,8),new o(60,12),new o(108,14),new o(159,30),new o(207,30),new o(255,30),new o(399,30),new o(447,30)],offset:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}]}},J={attackType1:{sprite:He,height:48,width:48,position:[new o(20,16),new o(84,17),new o(145,17),new o(208,17),new o(272,23),new o(343,25),new o(402,25),new o(460,25)],offset:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}]},enemyDead:{sprite:Be,height:48,width:48,position:[new o(12,8),new o(61,13),new o(109,15),new o(157,27),new o(205,27),new o(253,27),new o(397,27),new o(445,27)],offset:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}]}},Z={attackType1:{sprite:Oe,height:48,width:48,position:[new o(20,16),new o(84,17),new o(145,17),new o(208,17),new o(272,16),new o(343,9),new o(402,3),new o(460,0)],offset:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}]},enemyDead:{sprite:Ye,height:48,width:48,position:[new o(12,8),new o(61,13),new o(109,15),new o(157,27),new o(205,27),new o(253,27),new o(397,27),new o(445,27)],offset:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}]}};class qe{constructor(){r(this,"startPoint");r(this,"images_back");r(this,"images_front");r(this,"images_left");r(this,"images_right");r(this,"damage");r(this,"health");r(this,"movement_speed");r(this,"finalX");r(this,"finalY");r(this,"direction");r(this,"time");r(this,"h");r(this,"w");r(this,"r");r(this,"default_movement_speed");r(this,"default_damage");r(this,"default_health");r(this,"damageTimeout");r(this,"abilityTimeout");r(this,"isAttacking");r(this,"spritePos");r(this,"attackType");r(this,"isAlive");r(this,"hasWakeUp");r(this,"spawnEnemyInterval");r(this,"hasRoar");let t,i;Math.random()<.5?(t=R(e.bgImage.startPoint.x,e.bgImage.startPoint.x+100),i=R(e.bgImage.startPoint.y,e.bgImage.startPoint.y+e.bgImage.h)):(t=R(e.bgImage.startPoint.x,e.bgImage.startPoint.x+e.bgImage.w),i=R(e.bgImage.startPoint.y,e.bgImage.startPoint.y+100)),this.startPoint=new o(t,i),this.direction="d",this.h=tt,this.w=this.h,this.r=80,this.default_damage=it,this.damage=this.default_damage,this.images_back=A.bossImages.back,this.images_front=A.bossImages.front,this.images_left=A.bossImages.left,this.images_right=A.bossImages.right,this.time=0,this.damageTimeout=null,this.abilityTimeout=null,this.default_health=st,this.health=this.default_health,this.default_movement_speed=ot,this.movement_speed=this.default_movement_speed,this.finalX=e.player.startPoint.x,this.finalY=e.player.startPoint.y,this.isAttacking=!1,this.spritePos=0,this.attackType="attackType1",this.isAlive=!0,this.hasWakeUp=!1,this.spawnEnemyInterval=null,this.hasRoar=!1}updateAttributes(){E(this.startPoint,e.player.startPoint)>e.lantern.maxRadiusInnerCircle*2?(this.movement_speed=this.default_movement_speed*2,this.damage=this.default_damage*2,this.health=this.health<this.default_health?this.health:this.default_health*2):(this.movement_speed=this.default_movement_speed,this.damage=this.default_damage)}determineDirection(){const t=ye(new o(this.finalX,this.finalY),this.startPoint)*(180/Math.PI);t>=-45&&t<45?this.direction="r":t>=45&&t<135?this.direction="d":t>=-135&&t<-45?this.direction="u":this.direction="l"}show(t=e.ctx){if(Math.floor(this.health)>0&&e.bgImage.name!="house.png"){if(this.isAttacking){let l=Math.floor(this.spritePos/5)%8;this.direction=="l"?t.drawImage(Q[this.attackType].sprite,Q[this.attackType].position[l].x-10,Q[this.attackType].position[l].y-10,48,48,this.startPoint.x,this.startPoint.y,this.w,this.h):this.direction=="r"?t.drawImage(V[this.attackType].sprite,V[this.attackType].position[l].x-10,V[this.attackType].position[l].y-10,48,48,this.startPoint.x,this.startPoint.y,this.w,this.h):this.direction=="d"?t.drawImage(J[this.attackType].sprite,J[this.attackType].position[l].x-10,J[this.attackType].position[l].y-10,48,48,this.startPoint.x,this.startPoint.y,this.w,this.h):this.direction=="u"&&t.drawImage(Z[this.attackType].sprite,Z[this.attackType].position[l].x-10,Z[this.attackType].position[l].y-10,48,48,this.startPoint.x,this.startPoint.y,this.w,this.h)}else if(!this.isAttacking){let l=Math.floor(this.spritePos/5)%this.images_right.length,h=this.images_right[l];this.direction=="r"?h=this.images_right[l]:this.direction=="l"?h=this.images_left[l]:this.direction=="u"?h=this.images_back[l]:this.direction=="d"&&(h=this.images_front[l]),t.drawImage(h,this.startPoint.x,this.startPoint.y,this.w,this.h)}this.spritePos++,t.fillStyle="rgba(20, 20, 20, 0.6)",t.beginPath();const i=this.w/3,s=this.h/10;t.ellipse(this.startPoint.x+this.w/2,this.startPoint.y+this.h-10,i,s,0,0,2*Math.PI),t.fill()}else if(this.isAlive){let s=Math.floor(this.spritePos/5)%8;this.direction=="l"?t.drawImage(Q.enemyDead.sprite,Q.enemyDead.position[s].x-10,Q.enemyDead.position[s].y-10,48,48,this.startPoint.x,this.startPoint.y,this.w,this.h):this.direction=="r"?t.drawImage(V.enemyDead.sprite,V.enemyDead.position[s].x-10,V.enemyDead.position[s].y-10,48,48,this.startPoint.x,this.startPoint.y,this.w,this.h):this.direction=="d"?t.drawImage(J.enemyDead.sprite,J.enemyDead.position[s].x-10,J.enemyDead.position[s].y-10,48,48,this.startPoint.x,this.startPoint.y,this.w,this.h):this.direction=="u"&&t.drawImage(Z.enemyDead.sprite,Z.enemyDead.position[s].x-10,Z.enemyDead.position[s].y-10,48,48,this.startPoint.x,this.startPoint.y,this.w,this.h),this.spritePos++,this.spritePos%40==0&&(this.isAlive=!1)}}move(){if(this.health>0){let t=E(e.player.startPoint,this.startPoint);if(this.health<20&&(this.hasRoar=!0,y(d.bossroar,1),setTimeout(()=>{y(d.bosscallingallgoblins,1)},3e3)),t<400&&!this.hasWakeUp&&(this.hasWakeUp=!0,y(d.bosswakeup,1),setTimeout(()=>{y(d.bosshaswakenup,1)},3e3)),this.hasWakeUp){let i=this.finalX-this.startPoint.x,s=this.finalY-this.startPoint.y,n=E(new o(this.finalX,this.finalY),this.startPoint);if(n>this.movement_speed){let l=this.movement_speed/n,h=l*i,f=l*s;e.bgImage.checkCollision(this.startPoint.x+h,this.startPoint.y)||(this.startPoint.x+=h),e.bgImage.checkCollision(this.startPoint.x,this.startPoint.y+f)||(this.startPoint.y+=f),this.isAttacking=!1,e.player.health>0?this.abilityTimeout||(this.abilityTimeout=setTimeout(()=>{this.useAbility(),this.abilityTimeout=null},R(2,4)*1e3)):clearTimeout(this.abilityTimeout)}else this.isAttacking=!0,this.attack()}}}spawnEnemy(){!this.hasWakeUp&&e.enemiesArray.length<50?this.spawnEnemyInterval||(this.spawnEnemyInterval=setInterval(()=>{e.gameState!=g.paused&&(Qe(1),Ke(1))},at)):(clearInterval(this.spawnEnemyInterval),this.spawnEnemyInterval=null)}attack(){e.player.health>0?this.damageTimeout||(this.damageTimeout=setTimeout(()=>{e.player.health-=this.damage,y(d.ithurts,.01),this.damageTimeout=null},400)):clearTimeout(this.damageTimeout)}useAbility(){const t=new Ue(new o(this.startPoint.x+this.w/2,this.startPoint.y+50),this.direction,e.player.startPoint,"boss");e.fireProjectileArray.push(t)}}class Qt{constructor(){r(this,"h");r(this,"w");r(this,"borderRadius");r(this,"color");r(this,"padding");r(this,"img");r(this,"isHoveringCloseButton");this.h=c.height*.9,this.w=c.width*.8,this.borderRadius=20,this.color="#FFFAFA",this.padding=20,this.img=new Image,this.img.src="./assets/controls.png",this.img.onload=u,this.isHoveringCloseButton=!1}drawRoundedRect(t,i,s,n,l,h){t.beginPath(),t.moveTo(i+h,s),t.lineTo(i+n-h,s),t.quadraticCurveTo(i+n,s,i+n,s+h),t.lineTo(i+n,s+l-h),t.quadraticCurveTo(i+n,s+l,i+n-h,s+l),t.lineTo(i+h,s+l),t.quadraticCurveTo(i,s+l,i,s+l-h),t.lineTo(i,s+h),t.quadraticCurveTo(i,s,i+h,s),t.closePath(),t.fill()}drawCloseButton(t,i,s,n,l){t.beginPath(),t.arc(s+l/2,n+l/2,l/2,0,Math.PI*2),t.fill(),t.fillStyle="#FFFFFF",t.font="bold 20px Outfit",t.fillStyle=i,t.textAlign="center",t.fillText("X",s+7,n+23)}show(t=e.ctx){const i=(c.width-this.w)/2,s=(c.height-this.h)/2;t.fillStyle="rgba(0, 0, 0, 0.8)",t.fillRect(0,0,c.width,c.height),t.fillStyle=this.color,this.drawRoundedRect(t,i,s,this.w,this.h,this.borderRadius);const n=this.w-2*this.padding,l=this.h-2*this.padding,h=i+this.padding,f=s+this.padding;t.drawImage(this.img,h,f,n,l);const p=30,P=i+this.w-p-this.padding,m=s+this.padding,w=this.isHoveringCloseButton?"red":"#222222";this.drawCloseButton(t,w,P,m,p),c.addEventListener("mousemove",x=>{const b=Xe(x),I=b.x,F=b.y;this.isHoveringCloseButton=I>P&&I<P+p&&F>m&&F<m+p}),c.addEventListener("click",()=>{this.isHoveringCloseButton&&(e.tempGameState==g.loadingScreen?(e.gameState=g.menuScreen,e.tempGameState=g.menuScreen):e.gameState=e.tempGameState)})}}class Vt{constructor(){r(this,"h");r(this,"w");r(this,"borderRadius");r(this,"color");r(this,"padding");r(this,"img");r(this,"isHoveringMuteButton");r(this,"isHoveringSkipButton");r(this,"mute");this.h=c.height*.9,this.w=c.width*.8,this.borderRadius=20,this.color="#FFFAFA",this.padding=20,this.img=new Image,this.img.src="./assets/controls.png",this.img.onload=u,this.isHoveringMuteButton=!1,this.isHoveringSkipButton=!1,this.mute=!1}drawRoundedRect(t,i,s,n,l,h){t.beginPath(),t.moveTo(i+h,s),t.lineTo(i+n-h,s),t.quadraticCurveTo(i+n,s,i+n,s+h),t.lineTo(i+n,s+l-h),t.quadraticCurveTo(i+n,s+l,i+n-h,s+l),t.lineTo(i+h,s+l),t.quadraticCurveTo(i,s+l,i,s+l-h),t.lineTo(i,s+h),t.quadraticCurveTo(i,s,i+h,s),t.closePath(),t.fill()}show(t=e.ctx){y(d.aboutvoice,1);const i=(c.width-this.w)/2,s=(c.height-this.h)/2;t.fillStyle="rgba(0, 0, 0, 0.8)",t.fillRect(0,0,c.width,c.height),t.fillStyle=this.color,this.drawRoundedRect(t,i,s,this.w,this.h,this.borderRadius),t.font="18px Outfit",t.fillStyle="#222",t.textAlign="center",t.textBaseline="top";const n=`The game "Eclipse of the Lantern" puts you in my shoes as I strive to protect our neighborhood from a relentless goblin invasion.
    Armed with a gun and an axe, I'm also blessed with special abilities that I can unleash after a cooldown period. Along the way,
    I gather essential items like medkits, fuel, and ammo to aid in my quest. I carry a lantern, my beacon in the dark, which dims
    over time, requiring constant attention to keep it lit. The lantern's light is crucial as it weakens the goblins, giving me an edge
    in combat. My ultimate goal is to track down the Goblin Boss hiding somewhere on the map. This menacing boss not only poses a significant
    threat but also spawns more goblins at regular intervals. I must provoke and defeat the Goblin Boss while fending off the goblin horde.
    Only by doing so can I restore peace to our beloved neighborhood.`,l=`1. Goblin Boss: Found at the map's edge, it spawns goblins and items every second. Provoke it by approaching, and it will chase me, 
    stopping the spawns. Watch out for its flame ability.
2. Survival: The game ends if my lantern runs out or my health drops to zero. Collect fuel to refuel the lantern (takes 2 seconds)
and medkits to heal (takes 0.5 seconds). Gather ammo for my gun.

3. Lantern Light: Goblins weaken in the lantern's light, so it's best to kill them there.

4. Abilities: - "Light of Blessings": Screen-wide vision for 5 seconds (30s cooldown).
- "Breath of Dragon": Shoots a flame (20s cooldown).

5. Debug Mode: Hold the L key if I get stuck to move freely.

6. Safe House: Enter the house near the spawn point to reset health and stamina. 
Equip with 100 ammo, 5 medkits, and 5 fuel. No goblins can enter.

Good luck and have fun!`,h=n.split(`
`),f=20,p=l.split(`
`);let P=s+this.padding;h.forEach((F,z)=>{t.fillText(F,c.width/2,P+z*f)}),t.font="bold 25px Outfit",t.fillStyle="#111",t.fillText("Important Instructions",c.width/2,.35*c.height),t.font="18px Outfit",t.fillStyle="#222",p.forEach((F,z)=>{t.fillText(F,c.width/2,.35*c.height+z*f+50)}),t.fillStyle=this.color;let m=c.width-170-.1*c.width,w=.8*c.height;const x=150,b=40,I=10;t.strokeStyle="#000000",t.lineWidth=2,this.isHoveringSkipButton?t.fillStyle="red":t.fillStyle="#000000",t.fillText("Skip",m+x/2,w+b/2),t.beginPath(),t.moveTo(m+I,w),t.lineTo(m+x-I,w),t.quadraticCurveTo(m+x,w,m+x,w+I),t.lineTo(m+x,w+b-I),t.quadraticCurveTo(m+x,w+b,m+x-I,w+b),t.lineTo(m+I,w+b),t.quadraticCurveTo(m,w+b,m,w+b-I),t.lineTo(m,w+I),t.quadraticCurveTo(m,w,m+I,w),t.closePath(),t.stroke(),m=c.width-170-.1*c.width,w=.8*c.height-b-20,this.isHoveringMuteButton?t.fillStyle="red":t.fillStyle="#000000",this.mute?t.fillText("Muted",m+x/2,w+b/2):t.fillText("Mute",m+x/2,w+b/2),t.beginPath(),t.moveTo(m+I,w),t.lineTo(m+x-I,w),t.quadraticCurveTo(m+x,w,m+x,w+I),t.lineTo(m+x,w+b-I),t.quadraticCurveTo(m+x,w+b,m+x-I,w+b),t.lineTo(m+I,w+b),t.quadraticCurveTo(m,w+b,m,w+b-I),t.lineTo(m,w+I),t.quadraticCurveTo(m,w,m+I,w),t.closePath(),t.stroke(),c.addEventListener("mousemove",F=>{const z=Xe(F),re=z.x,le=z.y;this.isHoveringMuteButton=re>m&&re<m+x&&le>w&&le<w+b,this.isHoveringSkipButton=re>m&&re<m+x&&le>w+b+20&&le<w+2*b+20}),c.addEventListener("click",()=>{this.isHoveringMuteButton?(this.mute=!this.mute,this.mute?(d.aboutvoice.audio.pause(),d.aboutvoice.audio.currentTime=0):d.aboutvoice.audio.play()):this.isHoveringSkipButton&&(e.tempGameState==g.loadingScreen?(e.gameState=g.controlsScreen,d.aboutvoice.audio.pause(),d.aboutvoice.audio.currentTime=0):(e.gameState=e.tempGameState,d.aboutvoice.audio.pause(),d.aboutvoice.audio.currentTime=0))})}}async function Jt(){const a=new FontFace("Nos","url(assets/font/Nos.ttf)");await a.load(),document.fonts.add(a);const t=new FontFace("stat","url(assets/font/stat.ttf)");await t.load(),document.fonts.add(t);const i=new FontFace("Outfit","url(assets/font/Outfit.ttf)");await i.load(),document.fonts.add(i)}class Zt{constructor(){r(this,"h");r(this,"w");r(this,"borderRadius");r(this,"color");r(this,"padding");r(this,"loadProgress");this.h=c.height*.9,this.w=c.width*.8,this.borderRadius=20,this.color="#FFFAFA",this.padding=20,this.loadProgress=0,this.initFonts()}async initFonts(){await Jt()}show(t=e.ctx){const i=(c.width-this.w)/2,s=(c.height-this.h)/2;t.fillStyle="rgba(0, 0, 0, 0.8)",t.fillRect(0,0,c.width,c.height),t.fillStyle=this.color,this.drawRoundedRect(t,i,s,this.w,this.h,this.borderRadius);const n=this.w*.6,l=20,h=i+(this.w-n)/2,f=s+(this.h-l)/2;t.fillStyle="#CCCCCC",t.fillRect(h,f,n,l);const p="Loading...",P=i+(this.w-t.measureText(p).width)/2,m=f+l+80;t.fillStyle="#000000",t.font="20px Outfit",this.loadProgress=e.assetsLoadCount/180,t.fillStyle="#00FF00",t.fillRect(h,f,this.loadProgress*n,l),e.assetsLoadCount>=180?this.showCompletionMessage(t,i,P,f,h,f,n,l,p):(t.fillStyle="#000000",t.fillText(p,P,m))}drawRoundedRect(t,i,s,n,l,h){t.beginPath(),t.moveTo(i+h,s),t.lineTo(i+n-h,s),t.quadraticCurveTo(i+n,s,i+n,s+h),t.lineTo(i+n,s+l-h),t.quadraticCurveTo(i+n,s+l,i+n-h,s+l),t.lineTo(i+h,s+l),t.quadraticCurveTo(i,s+l,i,s+l-h),t.lineTo(i,s+h),t.quadraticCurveTo(i,s,i+h,s),t.closePath(),t.fill()}showCompletionMessage(t=e.ctx,i,s,n,l,h,f,p,P){t.clearRect(l,h,f,p),t.clearRect(s,n-20,t.measureText(P).width,30);const m="Press any key or click to continue",w=i+(this.w-t.measureText(m).width)/2,x=h+p+30;t.fillStyle="#000000",t.fillText(m,w,x);function b(){window.removeEventListener("keydown",b),c.removeEventListener("click",b),e.gameState=g.aboutScreen}window.addEventListener("keydown",b),c.addEventListener("click",b)}}function ei(){e.bgImage=new ut("main-map.jpg"),e.bgImage.initialiseImages(),e.player=new mt,e.player.direction="r",e.player.startPoint.x=e.windowWidth/2,e.player.startPoint.y=e.windowHeight/2,e.ui=new kt,M.axe.src="./assets/attack.png",M.axe.onload=u,M.gun.src="./assets/crosshair.png",M.gun.onload=u,M.direction.src="./assets/direction.png",M.direction.onload=u,e.cursorImage=M.axe,e.inventory=new Lt,e.axe=new Ft,e.gun=new Xt,e.inventory.initialiseImages(),e.ui.initialiseImages("./assets/ui"),e.ui.initialiseRainParticles(),e.lantern=new ft,e.lantern.img.src="assets/lantern/lantern.png",e.lantern.img.onload=u,e.mainMenu=new Tt,e.controlsScreen=new Qt,e.aboutScreen=new Vt,e.loadingScreen=new Zt,e.boss=new qe;let a=new Se(e.boss.images_front,2);e.animateEnemyArray.push(a),e.mainMenu.initialiseImages(),e.flameImages=si("assets/flame",30),ie.axe.src="./assets/axe.png",ie.axe.onload=u,ie.gun.src="./assets/gun.png",ie.gun.onload=u,se.light.src="./assets/abilities/light.png",se.light.onload=u,se.flame.src="./assets/abilities/flame.png",se.flame.onload=u,ce.ammo.src="./assets/inventory/ammo.png",ce.ammo.onload=u,A.goblinImages.back=H("back",6,"assets/enemy/goblin"),A.goblinImages.front=H("front",6,"assets/enemy/goblin"),A.goblinImages.left=H("left",6,"assets/enemy/goblin"),A.goblinImages.right=H("right",6,"assets/enemy/goblin"),A.bossImages.back=H("back",6,"assets/boss"),A.bossImages.front=H("front",6,"assets/boss"),A.bossImages.left=H("left",6,"assets/boss"),A.bossImages.right=H("right",6,"assets/boss"),T.Ophelia.back=W("back",4,"assets/character/images/characters/Ophelia"),T.Ophelia.front=W("front",4,"assets/character/images/characters/Ophelia"),T.Ophelia.left=W("left",4,"assets/character/images/characters/Ophelia"),T.Ophelia.right=W("right",4,"assets/character/images/characters/Ophelia"),T.Noah.back=W("back",4,"assets/character/images/characters/Noah"),T.Noah.front=W("front",4,"assets/character/images/characters/Noah"),T.Noah.left=W("left",4,"assets/character/images/characters/Noah"),T.Noah.right=W("right",4,"assets/character/images/characters/Noah"),A.bloodParticleImages=ii(7,"assets/blood"),A.pickupItems.medkit=ti(11,de.health_pack.itemName,"assets/pickups/health_pack")}function W(a,t,i){const s=[];for(let n=1;n<=t;n++){const l=new Image;l.src=`${i}/${a}/${a} (${n}).png`,l.onload=u,s.push(l)}return s}function ti(a,t,i){let s=[];for(let n=1;n<=a;n++){const l=new Image;l.src=`${i}/${t} (${n}).png`,l.onload=u,s.push(l)}return s}function ii(a,t){const i=[];for(let s=0;s<=a;s++){const n=new Image;n.src=`${t}/sprite_${s}.png`,n.onload=u,i.push(n)}return i}function H(a,t,i){const s=[];for(let n=1;n<=t;n++){const l=new Image;l.src=`${i}/${a}/${a} (${n}).png`,l.onload=u,s.push(l)}return s}function si(a,t){const i=[];for(let s=0;s<t;s++){const n=new Image;n.src=`${a}/${s}.png`,n.onload=u,i.push(n)}return i}function oi(){c.width=window.innerWidth,c.height=window.innerHeight}function u(){e.assetsLoadCount++}function ai(){yi(),ct(),e.gameState=g.running,Qe(50),Ke(100),e.player.changeCharacter(B.character),e.player.direction="r",e.player.startPoint.x=e.windowWidth/2,e.player.startPoint.y=e.windowHeight/2,e.enemiesArray.forEach(a=>{a.MAX_HEALTH=he[B.difficultyLevel].enemyMaxHealth,a.MIN_HEALTH=he[B.difficultyLevel].enemyMinHealth,a.default_damage=he[B.difficultyLevel].enemyAttackDamage,a.default_movement_speed=he[B.difficultyLevel].enemySpeed}),setTimeout(()=>{y(d.letsstartkilling,1)},500)}function Ge(a,t){return me[e.bgImage.name].colliders.forEach(i=>{const s=20+(e.windowWidth/2+e.bgImage.startPoint.x-(i.x+e.adjustDeviceColliderX)),n=50+(e.windowHeight/2+e.bgImage.startPoint.y-(i.y+e.adjustDeviceColliderY)),l=s+Math.abs(i.x-i.w),h=n+Math.abs(i.y-i.h),f=Math.min(s,l),p=Math.max(s,l),P=Math.min(n,h),m=Math.max(n,h);if(a>=f&&a<=p&&t>=P&&t<=m)return!0}),!1}function ni(){me[e.bgImage.name].colliders.forEach(a=>{e.ctx.fillStyle=a.color||"#ffffff",e.ctx.beginPath(),e.ctx.fillRect(20+(e.windowWidth/2+e.bgImage.startPoint.x-(a.x+e.adjustDeviceColliderX)),50+(e.windowHeight/2+e.bgImage.startPoint.y-(a.y+e.adjustDeviceColliderY)),Math.abs(a.x-a.w),Math.abs(a.y-a.h))})}function ri(){(e.player.health<=0||e.lantern.maxRadiusInnerCircle<=0)&&(e.gameState=g.retryScreen)}function li(a=e.ctx){a.save(),e.player.abilityMode?(e.cursorImage=M.direction,a.translate(e.mouseCoords.x,e.mouseCoords.y),a.rotate(Math.atan2(e.mouseCoords.y-e.player.startPoint.y+50,e.mouseCoords.x-e.player.startPoint.x+30)),a.drawImage(e.cursorImage,0,0,50,50),a.restore()):e.player.currWeapon=="gun"?(e.cursorImage=M.gun,a.drawImage(e.cursorImage,e.mouseCoords.x,e.mouseCoords.y,30,30)):(e.cursorImage=M.axe,a.drawImage(e.cursorImage,e.mouseCoords.x,e.mouseCoords.y,30,30))}function Ke(a){for(;a!=0;){const t=Math.random()<.8?Math.random()<.5?de.ammo:de.health_pack:de.fuel;let i=R(e.bgImage.startPoint.x,e.bgImage.startPoint.x+e.bgImage.w),s=R(e.bgImage.startPoint.y,e.bgImage.startPoint.y+e.bgImage.h);if(!Ge(i,s)){const n=new Et(i,s,t);e.pickupItemsArray.push(n);const l=new Se(n.images,12);e.animatePickupItemsArray.push(l),a--}}}function hi(){for(let a=0;a<e.pickupItemsArray.length;a++)e.pickupItemsArray[a].show(e.pickupItemsArray[a].images[e.animatePickupItemsArray[a].frame()],e.animatePickupItemsArray[a].frame()),e.animatePickupItemsArray[a].change_frames(),e.pickupItemsArray[a].collect(),e.pickupItemsArray[a].isUsed&&(e.pickupItemsArray.splice(a,1),e.animatePickupItemsArray.splice(a,1))}function di(){e.gameState=g.running}function yi(){e.player.health=100,e.player.score=0,e.lantern.maxRadiusInnerCircle=ne,e.bgImage.startPoint=new o(-2220+e.adjustDeviceColliderX,-2220+e.adjustDeviceColliderY),e.boss=new qe,e.bloodParticleArray=[],e.bulletProjectileArray=[],e.fireProjectileArray=[],e.enemiesArray=[],e.pickupItemsArray=[],e.keyState={},e.animateEnemyArray=[],e.animatePickupItemsArray=[],e.inventory.abilities[0].cooldown=0,e.inventory.abilities[1].cooldown=0,S.medKit=0,S.fuel=0,S.ammo=100}function ci(){e.inventory.show()}function mi(){e.ui.renderHealth(),e.ui.renderStamina(),e.ui.renderScore()}function $e(){e.mainMenu.show()}function ui(){e.enemiesArray.forEach(a=>{a.show(),a.move(),a.determineDirection(),a.updateAttributes(),a.separate()})}function gi(){e.boss.show(),e.boss.move(),e.boss.determineDirection(),e.boss.updateAttributes(),e.boss.spawnEnemy()}function Xe(a){const t=c.getBoundingClientRect(),i=a.clientX-t.left,s=a.clientY-t.top;return{x:i,y:s}}function fi(){e.bulletProjectileArray.forEach(a=>{a.show(),a.move()}),e.bulletProjectileArray=e.bulletProjectileArray.filter(a=>!a.toDelete),e.fireProjectileArray.forEach(a=>{a.show(),a.move()}),e.fireProjectileArray=e.fireProjectileArray.filter(a=>!a.toDelete)}function ze(){let a=0,t="";e.isHoldingRefuelKey?(a=e.refuelDuration,t=" Refueling Lantern",y(d.refueling,1)):e.isHoldingHealKey&&(a=e.healDuration,t=" Using Med Kit",y(d.usingmedkit,1));const i=new Date().getTime();let s=0;e.isHoldingHealKey&&(s=i-e.healStart),e.isHoldingRefuelKey&&(s=i-e.refuelStart);const n=a-s;n<0&&(e.isHoldingHealKey=!1,e.isHoldingRefuelKey=!1);const l=1-Math.min(s/a,1),h=400,f=20,p=(e.windowWidth-h)/2,P=e.windowHeight-50;e.ctx.fillStyle="#ccc",e.ctx.fillRect(p,P,h,f),e.ctx.fillStyle="#76c7c0",e.ctx.fillRect(p,P,h*l,f),e.ctx.font="16px Outfit",e.ctx.fillStyle="#fff",e.ctx.textAlign="center",e.ctx.fillText(`${t} ${(n/1e3).toFixed(1)}s`,e.windowWidth/2,P-10)}function Qe(a){for(;a!=0;){let t=R(e.bgImage.startPoint.x,e.bgImage.startPoint.x+e.bgImage.w),i=R(e.bgImage.startPoint.y,e.bgImage.startPoint.y+e.bgImage.h);if(!Ge(t,i)){let s=new vt(t,i),n=new Se(s.images_front,2);e.enemiesArray.push(s),e.animateEnemyArray.push(n),a--}}}function L(a,t,i,s,n){a.beginPath(),a.ellipse(t,i,s/2,n/2,0,0,Math.PI*2),a.fill(),a.closePath()}function wi(){if(e.player.currWeapon=="gun")e.bulletProjectileArray.forEach(a=>{for(let t=0;t<e.enemiesArray.length;t++)if(a.hits(e.enemiesArray[t])){e.enemiesArray[t].health-=1,a.evaporate(),y(d.diegoblins,.001);const i=new oe(e.enemiesArray[t].startPoint.x-e.bgImage.startPoint.x,e.enemiesArray[t].startPoint.y-e.bgImage.startPoint.y);i.updateState(),e.bloodParticleArray.push(i)}});else if(e.player.currWeapon=="axe"&&e.player.isAttacking){for(let a=0;a<e.enemiesArray.length;a++)if(e.axe.hits(e.enemiesArray[a])){e.enemiesArray[a].health-=.1,y(d.diegoblins,.01);const t=new oe(e.enemiesArray[a].startPoint.x-e.bgImage.startPoint.x,e.enemiesArray[a].startPoint.y-e.bgImage.startPoint.y);t.updateState(),e.bloodParticleArray.push(t)}}e.fireProjectileArray.forEach(a=>{if(a.owner=="player"){for(let t=0;t<e.enemiesArray.length;t++)if(a.hits(e.enemiesArray[t])){e.enemiesArray[t].health-=5;const i=new oe(e.enemiesArray[t].startPoint.x-e.bgImage.startPoint.x,e.enemiesArray[t].startPoint.y-e.bgImage.startPoint.y);i.updateState(),e.bloodParticleArray.push(i),e.enemiesArray[t].isAlive||(e.player.score++,e.enemiesArray.splice(t,1),e.animateEnemyArray.splice(t,1))}}else a.owner=="boss"&&a.hits(e.player)&&(e.player.health-=10,a.evaporate(),y(d.ithurts,1))});for(let a=0;a<e.enemiesArray.length;a++)e.enemiesArray[a].isAlive||(e.player.score++,e.enemiesArray.splice(a,1),e.animateEnemyArray.splice(a,1));for(let a=e.bloodParticleArray.length-1;a>=0;a--)e.bloodParticleArray[a].showAnimation(),e.bloodParticleArray[a].show||e.bloodParticleArray.splice(a,1)}function pi(){if(e.boss.health>0){if(e.boss.hasWakeUp){if(e.player.currWeapon=="gun")e.bulletProjectileArray.forEach(a=>{if(a.hits(e.boss)){e.boss.health-=1,a.evaporate(),y(d.diegoblins,.01);const t=new oe(e.boss.startPoint.x-e.bgImage.startPoint.x,e.boss.startPoint.y-e.bgImage.startPoint.y);t.updateState(),e.bloodParticleArray.push(t)}});else if(e.player.currWeapon=="axe"&&e.player.isAttacking&&e.axe.hits(e.boss)){e.boss.health-=.1,y(d.diegoblins,.001);const a=new oe(e.boss.startPoint.x-e.bgImage.startPoint.x,e.boss.startPoint.y-e.bgImage.startPoint.y);a.updateState(),e.bloodParticleArray.push(a)}e.fireProjectileArray.forEach(a=>{if(a.owner=="player"&&a.hits(e.boss)){e.boss.health-=10,a.evaporate();const t=new oe(e.boss.startPoint.x-e.bgImage.startPoint.x,e.boss.startPoint.y-e.bgImage.startPoint.y);t.updateState(),e.bloodParticleArray.push(t)}})}}else e.boss.isAlive=!1}window.addEventListener("keydown",function(a){e.keyState[a.keyCode||a.which]=!0},!0);window.addEventListener("keyup",function(a){e.keyState[a.keyCode||a.which]=!1},!0);window.addEventListener("mousemove",function(a){e.mouseCoords=Xe(a)},!0);window.addEventListener("click",function(){e.gameState!=g.running&&e.gameState!=g.controlsScreen&&e.gameState!=g.aboutScreen&&e.gameState!=g.loadingScreen&&e.mainMenu.handleSelect()},!0);window.addEventListener("click",()=>{if(e.gameState==g.running&&!e.player.isBlowingLantern&&e.player.health>0){const a=ye(new o(e.mouseCoords.x,e.mouseCoords.y),e.player.startPoint)*(180/Math.PI);a>=-45&&a<45?e.player.direction="r":a>=45&&a<135?e.player.direction="d":a>=-135&&a<-45?e.player.direction="u":e.player.direction="l",e.player.abilityMode?e.player.useAbility("flame"):e.player.currWeapon=="gun"?S.ammo>0?(e.player.isAttacking=!0,e.gun.fire(),y(d.gunfire,.5)):e.inventory.displayMessage(e.ctx,"ammo"):e.player.currWeapon=="axe"&&(e.player.isAttacking=!0,e.axe.calculateShockPoint(),y(d.axesound,.5))}});let ee=null,te=null;function bi(){e.keyState[87]&&e.keyState[68]?(e.player.direction="u",e.player.dirX=-.72,e.player.dirY=.72,e.player.move()):e.keyState[87]&&e.keyState[65]?(e.player.direction="u",e.player.dirX=.72,e.player.dirY=.72,e.player.move()):e.keyState[83]&&e.keyState[65]?(e.player.direction="d",e.player.dirX=.72,e.player.dirY=-.72,e.player.move()):e.keyState[83]&&e.keyState[68]?(e.player.direction="d",e.player.dirX=-.72,e.player.dirY=-.72,e.player.move()):e.keyState[65]?(e.player.direction="l",e.player.dirX=1,e.player.dirY=0,e.player.move()):e.keyState[68]?(e.player.direction="r",e.player.dirX=-1,e.player.dirY=0,e.player.move()):e.keyState[83]?(e.player.direction="d",e.player.dirX=0,e.player.dirY=-1,e.player.move()):e.keyState[87]?(e.player.direction="u",e.player.dirX=0,e.player.dirY=1,e.player.move()):(e.player.frameToShow=0,e.player.dirX=0,e.player.dirY=0,e.player.isWalking=!1)}function Pi(){e.keyState[76]?e.debugCollider=!0:e.debugCollider=!1,e.keyState[69]?v.E||(e.player.useAbility("light"),v.E=!0):v.E=!1,e.keyState[80]&&(e.gameState=g.paused),e.keyState[82]?v.R||(e.inventory.abilities[1].cooldown==0?e.player.abilityMode=!0:(e.inventory.displayMessage(e.ctx,"","Ability on Cooldown!"),setTimeout(()=>{y(d.notready,1)},1e3),v.R=!0)):(e.player.abilityMode=!1,v.R=!1),e.keyState[16]&&!e.player.isBlowingLantern&&!e.player.isUsingMedkit?(e.player.frameTime=2,e.player.increaseSpeed(),e.player.isRunning=!0):(e.player.movement_speed=e.player.default_speed,e.player.frameTime=4,e.player.isRunning=!1),e.keyState[81]?v.Q||(e.player.currWeapon=="axe"?(e.player.currWeapon="gun",y(d.yaygun,1)):(e.player.currWeapon="axe",y(d.hmmaxe,1)),v.Q=!0):v.Q=!1,e.keyState[32]?v.SPACE||(!te&&e.player.health>0&&(S.medKit>0?(e.healStart=new Date().getTime(),e.isHoldingHealKey=!0,e.player.isUsingMedkit=!0,te=setTimeout(()=>{e.player.increaseHealth(),y(d.itfeelsgood,1),te=null,e.player.isUsingMedkit=!1,e.isHoldingHealKey=!1,e.healStart=null},e.healDuration)):e.inventory.displayMessage(e.ctx,"health_pack")),v.SPACE=!0):(te&&e.player.health>0&&(clearTimeout(te),te=null,e.isHoldingHealKey=!1,e.player.isUsingMedkit=!1,e.healStart=null),v.SPACE=!1),e.keyState[70]?v.F||(!ee&&e.player.health>0&&(S.fuel>0?(e.refuelStart=new Date().getTime(),e.isHoldingRefuelKey=!0,e.player.isBlowingLantern=!0,ee=setTimeout(()=>{y(d.refuelingdone,1),e.lantern.resetLuminosity(),S.fuel--,ee=null,e.player.isBlowingLantern=!1,e.isHoldingRefuelKey=!1,e.refuelStart=null},e.refuelDuration)):e.inventory.displayMessage(e.ctx,"fuel")),v.F=!0):(ee&&e.player.health>0&&(clearTimeout(ee),ee=null,e.isHoldingRefuelKey=!1,e.player.isBlowingLantern=!1,e.refuelStart=null),v.F=!1)}const c=document.querySelector("#gameCanvas");e.ctx=c.getContext("2d");c.width=e.windowWidth;c.height=e.windowHeight;c.addEventListener("contextmenu",function(a){a.preventDefault()});ei();function Ve(){oi(),e.bgImage.show(),e.gameState==g.loadingScreen&&e.loadingScreen.show(),e.gameState==g.aboutScreen&&e.aboutScreen.show(),e.gameState==g.controlsScreen&&e.controlsScreen.show(),yt(),e.gameState==g.running&&(e.bgImage.name!="house.png"?(e.ui.renderRainParticles(),hi(),wi(),e.player.show(),ui(),gi(),pi(),e.bgImage.showDepth(),e.lantern.showLuminosity(),e.lantern.changeLuminosity(),fi(),Pi()):(e.player.show(),e.bgImage.showDepth(),e.lantern.maxRadiusInnerCircle=250,e.player.health=100,e.player.stamina=100,S.ammo<100&&(S.ammo=100),S.fuel<5&&(S.fuel=5),S.medKit<5&&(S.medKit=5),y(d.homesweethome,1)),mi(),ci(),bi(),e.enemiesArray.length==0&&!e.boss.isAlive&&(y(d.wedidit,1),e.gameState=g.gameFinish),e.axe.calculateShockPoint(),e.isHoldingRefuelKey&&e.refuelStart!=null&&ze(),e.isHoldingHealKey&&e.healStart!=null&&ze(),ri()),(e.gameState==g.menuScreen||e.gameState==g.retryScreen)&&(e.lantern.showLuminosity(),e.ui.renderBloodOverlay(),e.lantern.maxRadiusInnerCircle=10,$e()),e.gameState==g.paused&&(e.lantern.showLuminosity(),e.ui.renderBloodOverlay(),$e()),e.debugCollider&&ni(),li(),e.reqAnimFrame=requestAnimationFrame(Ve)}e.reqAnimFrame=requestAnimationFrame(Ve);
